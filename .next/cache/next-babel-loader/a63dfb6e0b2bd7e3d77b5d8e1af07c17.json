{"ast":null,"code":"var _jsxFileName = \"/home/crmock/pideenlaequina/front/pages/index.js\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport Head from 'next/head';\nimport Loading from '../components/Loading';\nimport Ready from '../components/Ready';\nimport createAuth0Client from '@auth0/auth0-spa-js';\n\nclass Index extends Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"deviceLocation\", async () => {\n      await navigator.geolocation.getCurrentPosition(position => this.locationFromBrowser(position), err => this.locationFromIp());\n    });\n\n    _defineProperty(this, \"initializeAuth0\", async () => {\n      const config = {\n        domain: 'acacerca.auth0.com',\n        //process.env.AUTH0_DOMAIN,\n        client_id: 'd8Pv88MjaYWNSUKUHnO9JcudrUPZ6THl',\n        //process.env.AUTH0_CLIENT_ID,\n        redirect_uri: window.location.origin,\n        cacheLocation: 'localstorage'\n      };\n      const auth0Client = await createAuth0Client(config);\n      const isAuthenticated = await auth0Client.isAuthenticated();\n      const user = isAuthenticated ? await auth0Client.getUser() : null;\n      this.setState({\n        authClient: auth0Client,\n        isAuthenticated,\n        user\n      });\n    });\n\n    this.state = {\n      deviceLocation: null,\n      selectedLocation: null,\n      featuredStores: null,\n      stores: null,\n      orders: null,\n      authClient: null,\n      isAuthenticated: false,\n      user: null,\n      isReady: false\n    };\n  }\n\n  componentDidMount() {\n    this.deviceLocation();\n    this.initializeAuth0();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.state.authClient !== null && this.state.deviceLocation !== null && this.state.selectedLocation === null) {\n      let location = null;\n\n      if (this.state.user !== null && this.state.user.addresses !== null && this.state.user.addresses !== []) {\n        location = this.state.user.addresses[0];\n      } else {\n        location = this.state.deviceLocation;\n      }\n\n      this.updateSelectedLocation(location.lat, location.lng, location.address, location.type);\n    }\n\n    if (this.state.selectedLocation !== null && JSON.stringify(prevState.selectedLocation) !== JSON.stringify(this.state.selectedLocation)) {\n      this.featuredStores(this.state.selectedLocation.lat, this.state.selectedLocation.lng);\n      this.stores(this.state.selectedLocation.lat, this.state.selectedLocation.lng);\n    }\n\n    if (!this.state.isReady && this.state.selectedLocation !== null && this.state.stores !== null && this.state.featuredStores !== null) {\n      this.setState({\n        isReady: true\n      });\n    }\n  }\n\n  updateSelectedLocation(newLat, newLng, address, type) {\n    let location = {\n      lat: parseFloat(newLat),\n      lng: parseFloat(newLng),\n      address: address,\n      type: type\n    };\n    this.setState({\n      selectedLocation: location\n    }); //localStorage.setItem('_selectedLocationL', location)  \n  }\n\n  updateDeviceLocation(newLat, newLng, address) {\n    let location = {\n      lat: parseFloat(newLat),\n      lng: parseFloat(newLng),\n      address: address,\n      type: \"device\"\n    };\n    this.setState({\n      deviceLocation: location\n    }); //localStorage.setItem('_deviceLocation', location)  \n  }\n\n  async locationFromIp() {\n    let url = '/api/locationFromIp';\n    let res = await fetch(url).then(response => response.json());\n    let address = await this.addressFromLocation(lat, lng);\n    this.updateDeviceLocation(res.location.lat, res.location.lng, address);\n  }\n\n  async locationFromBrowser(position) {\n    let lat = position.coords.latitude;\n    let lng = position.coords.longitude;\n    let address = await this.addressFromLocation(lat, lng);\n    this.updateDeviceLocation(lat, lng, address);\n  }\n\n  async addressFromLocation(lat, lng) {\n    let url = '/api/addressFromLocation?lat=' + lat + '&lng=' + lng;\n    let res = await fetch(url).then(response => response.json());\n    return res.address;\n  }\n\n  async featuredStores(lat, lng) {\n    let url = '/api/featuredStores?lat=' + lat + '&lng=' + lng;\n    let res = await fetch(url).then(response => response.json());\n    this.setState({\n      featuredStores: res.stores\n    }); //localStorage.setItem('_featuredStores', JSON.stringify(res.stores))  \n  }\n\n  async stores(lat, lng) {\n    let url = '/api/stores?lat=' + lat + '&lng=' + lng;\n    let res = await fetch(url).then(response => response.json());\n    this.setState({\n      stores: res.stores\n    }); //localStorage.setItem('_stores', JSON.stringify(res.stores))  \n  }\n\n  render() {\n    const {\n      deviceLocation,\n      selectedLocation,\n      featuredStores,\n      stores,\n      orders,\n      authClient,\n      isAuthenticated,\n      user,\n      isReady\n    } = this.state;\n    const values = {\n      deviceLocation,\n      selectedLocation,\n      featuredStores,\n      stores,\n      orders,\n      isAuthenticated,\n      user,\n      isReady,\n      loginWithRedirect: (...p) => authClient.loginWithRedirect(...p),\n      getTokenSilently: (...p) => authClient.getTokenSilently(...p),\n      getIdTokenClaims: (...p) => authClient.getIdTokenClaims(...p),\n      logout: (...p) => authClient.logout(...p)\n    };\n    let google_url = 'https://maps.googleapis.com/maps/api/js?key=AIzaSyBt0ZCE1kAklBJiBnCYGX6kl0tglLcKlLI';\n    return __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 7\n      }\n    }, __jsx(Head, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }\n    }, __jsx(\"script\", {\n      type: \"text/javascript\",\n      src: google_url,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 11\n      }\n    })), !this.state.isReady ? __jsx(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 12\n      }\n    }) : __jsx(Ready, _extends({}, values, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 12\n      }\n    })));\n  }\n\n}\n\nexport default Index;","map":{"version":3,"sources":["/home/crmock/pideenlaequina/front/pages/index.js"],"names":["React","Component","ReactDOM","Head","Loading","Ready","createAuth0Client","Index","constructor","props","navigator","geolocation","getCurrentPosition","position","locationFromBrowser","err","locationFromIp","config","domain","client_id","redirect_uri","window","location","origin","cacheLocation","auth0Client","isAuthenticated","user","getUser","setState","authClient","state","deviceLocation","selectedLocation","featuredStores","stores","orders","isReady","componentDidMount","initializeAuth0","componentDidUpdate","prevProps","prevState","addresses","updateSelectedLocation","lat","lng","address","type","JSON","stringify","newLat","newLng","parseFloat","updateDeviceLocation","url","res","fetch","then","response","json","addressFromLocation","coords","latitude","longitude","render","values","loginWithRedirect","p","getTokenSilently","getIdTokenClaims","logout","google_url"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport ReactDOM from 'react-dom';\nimport Head from 'next/head'\nimport Loading from '../components/Loading';\nimport Ready from '../components/Ready';\nimport createAuth0Client from '@auth0/auth0-spa-js';\n\nclass Index extends Component {\n   \n  constructor(props)\n  {\n    super(props)\n    this. state = {\n      deviceLocation:null,\n      selectedLocation:null,\n\n      featuredStores:null,\n      stores:null,\n      orders:null,\n\n      authClient: null,\n      isAuthenticated: false,\n      user:null,\n\n      isReady:false\n    }\n  }\n\n  componentDidMount() {\n    this.deviceLocation()\n    this.initializeAuth0()\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if(this.state.authClient!==null\n      && this.state.deviceLocation!==null\n      && this.state.selectedLocation===null)\n    { \n      let location = null\n      if(this.state.user!==null\n        && this.state.user.addresses!==null\n        && this.state.user.addresses!==[])\n      {\n        location = this.state.user.addresses[0]\n      }\n      else\n      {\n        location = this.state.deviceLocation\n      }\n      this.updateSelectedLocation(location.lat, location.lng, location.address, location.type)\n    }\n    \n    if(this.state.selectedLocation !== null  \n      && JSON.stringify(prevState.selectedLocation) !== JSON.stringify(this.state.selectedLocation) )\n    {\n      this.featuredStores(this.state.selectedLocation.lat, this.state.selectedLocation.lng)\n      this.stores(this.state.selectedLocation.lat, this.state.selectedLocation.lng)\n    }\n\n    if(\n      !this.state.isReady \n      && this.state.selectedLocation !== null\n      && this.state.stores !== null\n      && this.state.featuredStores !== null)\n    {\n      this.setState({ isReady:true })\n    }\n  }\n  \n  deviceLocation = async () => {\n    await navigator.geolocation.getCurrentPosition(\n      position => this.locationFromBrowser(position), \n      err => this.locationFromIp()\n    )\n  }\n\n  updateSelectedLocation(newLat, newLng, address, type)\n  {\n    let location = {\n      lat:parseFloat(newLat), \n      lng:parseFloat(newLng),\n      address: address,\n      type: type\n    }\n    \n    this.setState({ \n      selectedLocation:location\n    })\n\n    //localStorage.setItem('_selectedLocationL', location)  \n  }\n\n  updateDeviceLocation(newLat, newLng, address)\n  {\n    let location = {\n      lat:parseFloat(newLat), \n      lng:parseFloat(newLng),\n      address: address,\n      type: \"device\"\n    }\n    \n    this.setState({ \n      deviceLocation:location\n    })\n\n    //localStorage.setItem('_deviceLocation', location)  \n  }\n\n  initializeAuth0 = async () => {\n    const config = {\n      domain: 'acacerca.auth0.com',//process.env.AUTH0_DOMAIN,\n      client_id: 'd8Pv88MjaYWNSUKUHnO9JcudrUPZ6THl',//process.env.AUTH0_CLIENT_ID,\n      redirect_uri: window.location.origin,\n      cacheLocation: 'localstorage'\n    }\n\n    const auth0Client = await createAuth0Client(config)\n    const isAuthenticated = await auth0Client.isAuthenticated()\n    const user = isAuthenticated ? await auth0Client.getUser() : null\n\n    this.setState({ authClient:auth0Client, isAuthenticated, user })\n  }\n\n  async locationFromIp()\n  {\n    let url = '/api/locationFromIp'\n    let res = await fetch(url).then(response=>response.json())\n    let address = await this.addressFromLocation(lat,lng)\n\n    this.updateDeviceLocation(res.location.lat, res.location.lng, address)\n  }\n\n  async locationFromBrowser(position)\n  {\n    let lat = position.coords.latitude\n    let lng = position.coords.longitude\n    let address = await this.addressFromLocation(lat,lng)\n\n    this.updateDeviceLocation(lat, lng, address)\n  }\n\n  async addressFromLocation(lat, lng)\n  {\n    let url = '/api/addressFromLocation?lat='+ lat +'&lng='+lng\n    let res = await fetch(url).then(response=>response.json())\n\n    return res.address\n  }\n\n  async featuredStores(lat, lng)\n  {\n    let url = '/api/featuredStores?lat='+ lat +'&lng='+lng\n    let res = await fetch(url).then(response=>response.json())\n    \n    this.setState({ featuredStores:res.stores })\n    //localStorage.setItem('_featuredStores', JSON.stringify(res.stores))  \n  }\n\n  async stores(lat, lng)\n  {\n    let url = '/api/stores?lat='+ lat +'&lng='+lng\n    let res = await fetch(url).then(response=>response.json())\n    \n    this.setState({ stores:res.stores })\n    //localStorage.setItem('_stores', JSON.stringify(res.stores))  \n  }\n\n  render() {\n    const { \n      deviceLocation,\n      selectedLocation,\n      featuredStores,\n      stores,\n      orders,\n\n      authClient,\n      isAuthenticated,\n      user,\n\n      isReady\n    } = this.state;\n\n    const values = { \n      deviceLocation,\n      selectedLocation,\n      featuredStores,\n      stores,\n      orders,\n\n      isAuthenticated,\n      user,\n\n      isReady,\n\n      loginWithRedirect: (...p) => authClient.loginWithRedirect(...p),\n      getTokenSilently: (...p) => authClient.getTokenSilently(...p),\n      getIdTokenClaims: (...p) => authClient.getIdTokenClaims(...p),\n      logout: (...p) => authClient.logout(...p)\n    }\n\n    let google_url = 'https://maps.googleapis.com/maps/api/js?key=AIzaSyBt0ZCE1kAklBJiBnCYGX6kl0tglLcKlLI'\n\n    return(\n      <div>\n        <Head>\n          <script type=\"text/javascript\" src={google_url} ></script>\n        </Head>\n        {(\n          !this.state.isReady\n          ?<Loading/>\n          :<Ready {...values}/>\n        )}\n      </div>\n    )\n  }\n}\n\nexport default Index\n"]},"metadata":{},"sourceType":"module"}