{"ast":null,"code":"var _jsxFileName = \"/home/crmock/pideenlaequina/front/components/map.js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport Head from 'next/head';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Input from '@material-ui/core/Input';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport FormControl from '@material-ui/core/FormControl';\nimport Divider from '@material-ui/core/Divider';\nimport Typography from '@material-ui/core/Typography';\nimport Fab from '@material-ui/core/Fab';\nimport IconButton from '@material-ui/core/IconButton';\nimport SearchIcon from '@material-ui/icons/Search';\nimport AddLocationIcon from '@material-ui/icons/AddLocation';\nimport LocalShippingIcon from '@material-ui/icons/LocalShipping';\nimport PersonPinCircleIcon from '@material-ui/icons/PersonPinCircle';\nimport AddCircleOutlineIcon from '@material-ui/icons/AddCircleOutline';\nimport MyLocationIcon from '@material-ui/icons/MyLocation';\nimport NoStores from '../components/noStores.js';\nconst initialZoom = 15;\n\nclass Map extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      map: null,\n      userMarker: null,\n      storeMarkers: []\n    };\n  }\n\n  shouldComponentUpdate() {\n    if (this.props.pos == null) {\n      return false;\n    }\n\n    return true;\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (this.props.pos != null && this.props.stores != null) {\n      if (this.state.map == null) {\n        let map = this.getMap(this.props.pos);\n        let userMarker = this.placeUserMarker(map, this.props.pos);\n        let storeMarkers = this.placeAllStoreMarkers(map, this.props.stores);\n        this.setState({\n          userMarker: userMarker,\n          map: map,\n          storeMarkers: storeMarkers\n        });\n      } else if (prevProps.pos != this.props.pos) {\n        let userMarker = this.placeUserMarker(this.state.map, this.props.pos);\n        this.removeAllStoreMarkers();\n        let storeMarkers = this.placeAllStoreMarkers(this.state.map, this.props.stores);\n        this.setState({\n          userMarker: userMarker,\n          storeMarkers: storeMarkers\n        });\n      }\n    }\n  }\n\n  getMap(pos) {\n    let map = null;\n\n    if (this.state.map == null) {\n      map = new google.maps.Map(document.getElementById('map'), {\n        center: pos,\n        zoom: initialZoom,\n        zoomControl: false,\n        mapTypeControl: false,\n        fullscreenControl: false,\n        clickableIcons: false,\n        streetViewControl: false\n      });\n    } else {\n      map = this.state.map;\n    }\n\n    return map;\n  }\n\n  placeUserMarker(map, pos) {\n    if (this.state.userMarker != null) {\n      this.state.userMarker.setMap(null);\n    }\n\n    let marker = new google.maps.Marker({\n      position: pos,\n      icon: './map/user_icon.svg',\n      title: \"Tu ubicación\",\n      draggable: false\n    });\n    marker.setMap(map);\n    this.panToPos(map, pos);\n    return marker;\n  }\n\n  panToPos(map, pos) {\n    map.setZoom(initialZoom);\n    map.panTo(pos);\n  }\n\n  placeAllStoreMarkers(map, stores) {\n    let list = [];\n\n    for (let i = 0; i < stores.length; i++) {\n      let store = stores[i];\n\n      if (store._id == null || store.lat == null || store.lng == null || store.name == null) {\n        console.log(\"Skiped store: \" + store.name);\n        continue;\n      }\n\n      let marker = this.placeAStoreMarker(map, store);\n      list.push(marker);\n    }\n\n    return list;\n  }\n\n  removeAllStoreMarkers() {\n    for (let i = 0; i < this.state.storeMarkers.length; i++) {\n      this.state.storeMarkers[i].setMap(null);\n    }\n  }\n\n  placeAStoreMarker(map, store) {\n    store.type = store.type == null ? \"store\" : store.type.toLowerCase();\n    let icon_normal = './map/' + store.type + \"_icon.svg\";\n    let icon_hover = './map/' + store.type + \"_icon_hover.svg\";\n    let marker = new google.maps.Marker({\n      position: {\n        lat: store.lat,\n        lng: store.lng\n      },\n      icon: icon_normal,\n      title: store.name,\n      draggable: false,\n      id: store._id //custom data\n\n    });\n    google.maps.event.addListener(marker, 'click', function () {\n      console.log(\"click \" + marker.id);\n    });\n    google.maps.event.addListener(marker, 'mouseover', function () {\n      marker.setIcon(icon_hover);\n    });\n    google.maps.event.addListener(marker, 'mouseout', function () {\n      marker.setIcon(icon_normal);\n    });\n    marker.setMap(map);\n    return marker;\n  }\n\n  render() {\n    let customStyle = {\n      padding: \"0\",\n      margin: \"0\",\n      display: 'flex',\n      height: '97vh',\n      flexDirection: \"column-reverse\"\n    };\n    let google_url = process.env.GOOGLE_MAPS_API_URL + \"/js?key=\" + process.env.GOOGLE_MAPS_API_KEY;\n    return __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 7\n      }\n    }, __jsx(Head, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 9\n      }\n    }, __jsx(\"script\", {\n      src: google_url,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 11\n      }\n    })), __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 9\n      }\n    }, __jsx(\"div\", {\n      style: customStyle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 11\n      }\n    }, __jsx(\"div\", {\n      id: \"actions\",\n      style: {\n        background: 'gold',\n        height: \"600px\",\n        width: \"100%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 13\n      }\n    }, __jsx(Grid, {\n      container: true,\n      spacing: 3,\n      style: {\n        width: \"80%\",\n        marginTop: \"3%\",\n        marginLeft: \"auto\",\n        marginRight: \"auto\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 15\n      }\n    }, __jsx(Grid, {\n      item: true,\n      xs: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 17\n      }\n    }, __jsx(Paper, {\n      elevation: 3,\n      style: {\n        borderRadius: \"20px\",\n        paddingRight: '10%',\n        paddingLeft: '10%'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 19\n      }\n    }, __jsx(FormControl, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 21\n      }\n    }, __jsx(InputLabel, {\n      htmlFor: \"input-address\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 23\n      }\n    }, \"Ubicaci\\xF3n\"), __jsx(Input, {\n      id: \"input-addres\",\n      startAdornment: __jsx(InputAdornment, {\n        position: \"start\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 27\n        }\n      }, __jsx(PersonPinCircleIcon, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 29\n        }\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 23\n      }\n    })))), __jsx(Grid, {\n      item: true,\n      xs: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 17\n      }\n    }, __jsx(Fab, {\n      size: \"large\",\n      \"aria-label\": \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 19\n      }\n    }, __jsx(SearchIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 57\n      }\n    }))), __jsx(Grid, {\n      item: true,\n      xs: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 17\n      }\n    }, __jsx(Fab, {\n      size: \"large\",\n      \"aria-label\": \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 19\n      }\n    }, __jsx(AddLocationIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 57\n      }\n    }))), __jsx(Grid, {\n      item: true,\n      xs: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 17\n      }\n    }, __jsx(Fab, {\n      size: \"large\",\n      \"aria-label\": \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 19\n      }\n    }, __jsx(LocalShippingIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 57\n      }\n    })))), __jsx(Divider, {\n      variant: \"middle\",\n      style: {\n        marginTop: '5%',\n        marginBottom: \"5%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 15\n      }\n    }), __jsx(Grid, {\n      container: true,\n      spacing: 3,\n      style: {\n        width: \"80%\",\n        marginLeft: \"auto\",\n        marginRight: \"auto\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 15\n      }\n    }, __jsx(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 17\n      }\n    }, \"Favoritas\"), __jsx(Grid, {\n      item: true,\n      xs: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 17\n      }\n    }, __jsx(Fab, {\n      size: \"large\",\n      \"aria-label\": \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 19\n      }\n    }, __jsx(AddCircleOutlineIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 57\n      }\n    }))), __jsx(Grid, {\n      item: true,\n      xs: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 17\n      }\n    }, __jsx(Fab, {\n      size: \"large\",\n      \"aria-label\": \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 19\n      }\n    }, __jsx(AddCircleOutlineIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 57\n      }\n    }))), __jsx(Grid, {\n      item: true,\n      xs: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 17\n      }\n    }, __jsx(Fab, {\n      size: \"large\",\n      \"aria-label\": \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 19\n      }\n    }, __jsx(AddCircleOutlineIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 57\n      }\n    }))))), __jsx(\"div\", {\n      id: \"map\",\n      style: {\n        background: \"grey\",\n        height: \"100%\",\n        width: \"100%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 13\n      }\n    }, this.state.map ? __jsx(Fab, {\n      size: \"small\",\n      \"aria-label\": \"center\",\n      style: {\n        position: 'absolute',\n        bottom: \"5%\",\n        right: \"5%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 16\n      }\n    }, __jsx(MyLocationIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 111\n      }\n    })) : \"\")), this.state.map && this.props.stores.length == 0 ? __jsx(NoStores, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 14\n      }\n    }) : \"\"));\n  }\n\n}\n\nexport default Map;","map":{"version":3,"sources":["/home/crmock/pideenlaequina/front/components/map.js"],"names":["React","ReactDOM","Head","Grid","Paper","Input","InputLabel","InputAdornment","FormControl","Divider","Typography","Fab","IconButton","SearchIcon","AddLocationIcon","LocalShippingIcon","PersonPinCircleIcon","AddCircleOutlineIcon","MyLocationIcon","NoStores","initialZoom","Map","Component","constructor","props","state","map","userMarker","storeMarkers","shouldComponentUpdate","pos","componentDidUpdate","prevProps","prevState","stores","getMap","placeUserMarker","placeAllStoreMarkers","setState","removeAllStoreMarkers","google","maps","document","getElementById","center","zoom","zoomControl","mapTypeControl","fullscreenControl","clickableIcons","streetViewControl","setMap","marker","Marker","position","icon","title","draggable","panToPos","setZoom","panTo","list","i","length","store","_id","lat","lng","name","console","log","placeAStoreMarker","push","type","toLowerCase","icon_normal","icon_hover","id","event","addListener","setIcon","render","customStyle","padding","margin","display","height","flexDirection","google_url","process","env","GOOGLE_MAPS_API_URL","GOOGLE_MAPS_API_KEY","background","width","marginTop","marginLeft","marginRight","borderRadius","paddingRight","paddingLeft","marginBottom","bottom","right"],"mappings":"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","sourcesContent":["import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Head from 'next/head'\n\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Input from '@material-ui/core/Input';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport FormControl from '@material-ui/core/FormControl';\nimport Divider from '@material-ui/core/Divider';\nimport Typography from '@material-ui/core/Typography';\nimport Fab from '@material-ui/core/Fab';\n\nimport IconButton from '@material-ui/core/IconButton'\nimport SearchIcon from '@material-ui/icons/Search'\nimport AddLocationIcon from '@material-ui/icons/AddLocation'\nimport LocalShippingIcon from '@material-ui/icons/LocalShipping'\nimport PersonPinCircleIcon from '@material-ui/icons/PersonPinCircle'\nimport AddCircleOutlineIcon from '@material-ui/icons/AddCircleOutline'\nimport MyLocationIcon from '@material-ui/icons/MyLocation'\n\nimport NoStores from '../components/noStores.js'\n\nconst initialZoom = 15\n\nclass Map extends React.Component {\n\n  constructor(props)\n  {\n    super(props)\n    this.state = {\n      map: null,\n      userMarker:null,\n      storeMarkers:[]\n    }\n  }\n\n  shouldComponentUpdate() {\n    if(this.props.pos == null)\n    {\n      return false\n    }\n    return true\n  }\n\n  componentDidUpdate(prevProps, prevState) \n  {\n    if(this.props.pos != null && this.props.stores != null)\n    {\n      if(this.state.map == null)\n      {\n        let map=this.getMap(this.props.pos)\n        let userMarker=this.placeUserMarker(map, this.props.pos)\n        let storeMarkers = this.placeAllStoreMarkers(map, this.props.stores)\n\n        this.setState ({\n          userMarker:userMarker,\n          map: map,\n          storeMarkers: storeMarkers\n        })\n      }\n      else if(prevProps.pos != this.props.pos)\n      {\n        let userMarker=this.placeUserMarker(this.state.map, this.props.pos)\n        this.removeAllStoreMarkers()\n        let storeMarkers = this.placeAllStoreMarkers(this.state.map, this.props.stores)\n\n        this.setState ({\n          userMarker:userMarker,\n          storeMarkers: storeMarkers\n        })\n      }\n    }\n  }\n\n  getMap(pos)\n  {\n    let map = null\n    if(this.state.map == null)\n    {\n      map = new google.maps.Map(document.getElementById('map'), {\n        center: pos,\n        zoom: initialZoom,\n        zoomControl:false,\n        mapTypeControl: false,\n        fullscreenControl: false,\n        clickableIcons: false,\n        streetViewControl: false\n      })\n    }\n    else\n    {\n      map = this.state.map\n    }\n    return map\n  }\n\n  placeUserMarker(map, pos)\n  {\n    if(this.state.userMarker != null)\n    {\n      this.state.userMarker.setMap(null);\n    }\n\n    let marker = new google.maps.Marker({\n      position: pos,\n      icon: './map/user_icon.svg',\n      title: \"Tu ubicación\",\n      draggable:false,\n    })\n\n    marker.setMap(map);\n    this.panToPos(map, pos)\n\n    return marker\n  }\n\n  panToPos(map, pos)\n  {\n    map.setZoom(initialZoom);\n    map.panTo(pos);\n  }\n\n  placeAllStoreMarkers(map, stores)\n  {\n    let list = []\n    \n    for (let i = 0; i < stores.length; i++) {\n      let store = stores[i]\n      if(store._id == null || store.lat == null || store.lng == null || store.name == null)\n      {\n        console.log(\"Skiped store: \"+store.name)\n        continue\n      }\n\n      let marker = this.placeAStoreMarker(map, store)\n      list.push(marker)\n    }\n\n    return list\n  }\n\n  removeAllStoreMarkers()\n  {\n    for (let i = 0; i < this.state.storeMarkers.length; i++)\n    {\n      this.state.storeMarkers[i].setMap(null)\n    }\n  }\n\n  placeAStoreMarker(map, store)\n  {\n    store.type = (store.type==null?\"store\":store.type.toLowerCase())\n    let icon_normal = './map/' + store.type + \"_icon.svg\";\n    let icon_hover = './map/' + store.type + \"_icon_hover.svg\";\n    \n    let marker = new google.maps.Marker({\n      position: {lat:store.lat, lng:store.lng},\n      icon: icon_normal,\n      title:store.name,\n      draggable:false,\n      id:store._id, //custom data\n    })\n\n    google.maps.event.addListener(marker, 'click', function() {\n      console.log(\"click \" +marker.id)       \n    })\n\n    google.maps.event.addListener(marker, 'mouseover', function() {\n      marker.setIcon(icon_hover);\n    })\n\n    google.maps.event.addListener(marker, 'mouseout', function() {\n      marker.setIcon(icon_normal);    \n    })\n\n    marker.setMap(map)\n    return marker\n  }\n\n  render () {\n    let customStyle = {\n      padding:\"0\",\n      margin:\"0\",\n      display: 'flex',\n      height: '97vh',\n      flexDirection: \"column-reverse\"\n    }\n\n    let google_url = process.env.GOOGLE_MAPS_API_URL + \"/js?key=\"+process.env.GOOGLE_MAPS_API_KEY\n\n    return (\n      <div>\n        <Head>\n          <script src= {google_url}></script>\n        </Head>\n        <div>\n          <div style={customStyle}>\n            <div id=\"actions\" style={{background:'gold', height:\"600px\", width:\"100%\"}}>\n              <Grid container spacing={3} style={{width:\"80%\", marginTop:\"3%\", marginLeft:\"auto\", marginRight:\"auto\"}}>\n                <Grid item xs={12}>\n                  <Paper elevation={3} style={{borderRadius:\"20px\", paddingRight:'10%', paddingLeft:'10%'}}>\n                    <FormControl>\n                      <InputLabel htmlFor=\"input-address\">Ubicación</InputLabel>\n                      <Input\n                        id=\"input-addres\"\n                        startAdornment={\n                          <InputAdornment position=\"start\">\n                            <PersonPinCircleIcon />\n                          </InputAdornment>\n                        }\n                      />\n                    </FormControl>\n                  </Paper>\n                </Grid>\n                <Grid item xs={4}>\n                  <Fab size=\"large\" aria-label=\"center\"><SearchIcon /></Fab>\n                </Grid>\n                <Grid item xs={4}>\n                  <Fab size=\"large\" aria-label=\"center\"><AddLocationIcon /></Fab>\n                </Grid>\n                <Grid item xs={4}>\n                  <Fab size=\"large\" aria-label=\"center\"><LocalShippingIcon /></Fab>\n                </Grid>\n              </Grid>\n              <Divider variant=\"middle\" style={{marginTop:'5%', marginBottom:\"5%\"}}/>\n                \n              \n              <Grid container spacing={3} style={{width:\"80%\", marginLeft:\"auto\", marginRight:\"auto\"}}>\n                <span>Favoritas</span>\n                <Grid item xs={4}>\n                  <Fab size=\"large\" aria-label=\"center\"><AddCircleOutlineIcon /></Fab>\n                </Grid>\n                <Grid item xs={4}>\n                  <Fab size=\"large\" aria-label=\"center\"><AddCircleOutlineIcon /></Fab>\n                </Grid>\n                <Grid item xs={4}>\n                  <Fab size=\"large\" aria-label=\"center\"><AddCircleOutlineIcon /></Fab>\n                </Grid>\n              </Grid>\n              \n            </div>\n            <div id=\"map\" style={{background:\"grey\",height:\"100%\", width:\"100%\"}}>\n              {this.state.map\n              ?<Fab size=\"small\" aria-label=\"center\" style={{position: 'absolute', bottom:\"5%\", right:\"5%\"}} ><MyLocationIcon /></Fab>\n              :\"\"\n              }\n            </div>\n          </div>\n          \n          {this.state.map && this.props.stores.length==0\n            ?<NoStores/>\n            :\"\"\n          }\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Map\n"]},"metadata":{},"sourceType":"module"}