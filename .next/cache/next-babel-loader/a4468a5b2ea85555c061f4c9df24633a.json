{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/crmock/pideenlaequina/front/components/map.js\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport Head from 'next/head';\nimport AddressBar from '../components/addressBar.js';\nimport NoStores from '../components/noStores.js';\n\nvar Map = /*#__PURE__*/function (_React$Component) {\n  _inherits(Map, _React$Component);\n\n  var _super = _createSuper(Map);\n\n  function Map(props) {\n    var _this;\n\n    _classCallCheck(this, Map);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      map: null,\n      userMarker: null,\n      stores: []\n    };\n    return _this;\n  }\n\n  _createClass(Map, [{\n    key: \"render\",\n    value: function render() {\n      var customStyle = {\n        padding: \"0\",\n        margin: \"0\",\n        display: 'flex',\n        height: '97vh',\n        alignItems: 'center',\n        justifyContent: 'center',\n        background: 'WhiteSmoke'\n      };\n      var imageStyle = {\n        width: \"50%\",\n        marginLeft: \"auto\",\n        marginRight: \"auto\"\n      };\n\n      var handleOpen = function handleOpen() {\n        setOpen(true);\n      };\n\n      var handleClose = function handleClose() {\n        setOpen(false);\n      };\n\n      return __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 7\n        }\n      }, __jsx(Head, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 9\n        }\n      }, __jsx(\"script\", {\n        src: \"https://maps.googleapis.com/maps/api/js?key=AIzaSyBt0ZCE1kAklBJiBnCYGX6kl0tglLcKlLI\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 11\n        }\n      })), __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 9\n        }\n      }, __jsx(\"div\", {\n        id: \"map\",\n        style: customStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }\n      }, __jsx(\"img\", {\n        src: \"/loading.svg\",\n        alt: \"Pajarito escuchando m\\xFAsica feliz\",\n        style: imageStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 13\n        }\n      })), this.state.map ? __jsx(AddressBar, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 14\n        }\n      }) : \"\", this.state.map && !this.state.stores.length ? __jsx(NoStores, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 14\n        }\n      }) : \"\"));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, state) {\n      var newMap = null;\n      var newUserMarker = null;\n      var newStores = [];\n\n      if (typeof google !== 'undefined' && props.pos != null && props.pos.lat != null && props.pos.lng != null) {\n        newMap = this.getMap(props, state);\n        newUserMarker = this.getUser(props, state, newMap);\n        newStores = this.getSores(props, state, newMap);\n      }\n\n      return {\n        map: newMap,\n        userMarker: newUserMarker,\n        stores: newStores\n      };\n    }\n  }, {\n    key: \"getMap\",\n    value: function getMap(props, state) {\n      var map = null;\n\n      if (state.map == null) {\n        map = new google.maps.Map(document.getElementById('map'), {\n          center: props.pos,\n          zoom: 15,\n          mapTypeControl: false,\n          fullscreenControl: false\n        });\n      } else {\n        map = state.map;\n      }\n\n      return map;\n    }\n  }, {\n    key: \"getUser\",\n    value: function getUser(props, state, map) {\n      if (state.userMarker != null) {\n        state.userMarker.setMap(null);\n      }\n\n      var user = new google.maps.Marker({\n        position: props.pos,\n        icon: './map/user_icon.svg',\n        title: \"Tu ubicaci√≥n\",\n        draggable: false\n      });\n      user.setMap(map);\n      map.panTo(props.pos);\n      return user;\n    }\n  }, {\n    key: \"getStores\",\n    value: function getStores(props, state, map) {\n      var list = [];\n\n      if (Array.isArray(props.stores) && props.stores.length) {\n        stores = props.stores;\n\n        for (var _i = 0; _i < stores.length; _i++) {\n          store = this.storeMarker(stores[_i], map);\n          list.push(store);\n        }\n      } else {\n        for (var _i2 = 0; _i2 < state.stores.length; _i2++) {\n          state.stores[_i2].setMap(null);\n        }\n      }\n\n      return list;\n    }\n  }, {\n    key: \"storeMarker\",\n    value: function storeMarker(store, map) {\n      if (store.id == null || store.lat == null || store.lng == null || store.name == null) {\n        console.log(\"Skiped store #\" + i);\n      } else {\n        store.type = store.type == null ? \"store\" : store.type.toLowerCase();\n        var icon_normal = './map/' + store.type + \"_icon.svg\";\n        var icon_hover = './map/' + store.type + \"_icon_hover.svg\";\n\n        var _marker = new google.maps.Marker({\n          position: {\n            lat: store.lat,\n            lng: store.lng\n          },\n          icon: icon_normal,\n          title: store.name,\n          draggable: false,\n          id: store.id //custom data\n\n        });\n\n        google.maps.event.addListener(_marker, 'click', function () {\n          console.log(\"click \" + _marker.id);\n        });\n        google.maps.event.addListener(_marker, 'mouseover', function () {\n          _marker.setIcon(icon_hover);\n        });\n        google.maps.event.addListener(_marker, 'mouseout', function () {\n          _marker.setIcon(icon_normal);\n        });\n\n        _marker.setMap(map);\n      }\n\n      return marker;\n    }\n  }]);\n\n  return Map;\n}(React.Component);\n\nexport default Map;","map":{"version":3,"sources":["/home/crmock/pideenlaequina/front/components/map.js"],"names":["React","ReactDOM","Head","AddressBar","NoStores","Map","props","state","map","userMarker","stores","customStyle","padding","margin","display","height","alignItems","justifyContent","background","imageStyle","width","marginLeft","marginRight","handleOpen","setOpen","handleClose","length","newMap","newUserMarker","newStores","google","pos","lat","lng","getMap","getUser","getSores","maps","document","getElementById","center","zoom","mapTypeControl","fullscreenControl","setMap","user","Marker","position","icon","title","draggable","panTo","list","Array","isArray","i","store","storeMarker","push","id","name","console","log","type","toLowerCase","icon_normal","icon_hover","marker","event","addListener","setIcon","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Head from 'next/head'\nimport AddressBar from '../components/addressBar.js'\nimport NoStores from '../components/noStores.js'\n\nclass Map extends React.Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      map: null,\n      userMarker: null,\n      stores: []\n    }\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    let newMap = null\n    let newUserMarker = null\n    let newStores = []\n\n    if(typeof google !== 'undefined' && props.pos != null && props.pos.lat != null && props.pos.lng != null) \n    {\n      newMap = this.getMap(props, state)\n      newUserMarker = this.getUser(props, state, newMap)\n      newStores = this.getSores(props, state, newMap)\n    }\n\n    return {\n      map: newMap,\n      userMarker: newUserMarker,\n      stores:newStores\n    }\n  }\n\n  static getMap(props, state)\n  {\n    let map = null\n    if(state.map == null)\n    {\n      map = new google.maps.Map(document.getElementById('map'), {\n        center: props.pos,\n        zoom: 15,\n        mapTypeControl: false,\n        fullscreenControl: false,\n      })\n    }\n    else\n    {\n      map = state.map\n    }\n\n    return map\n  }\n\n  static getUser(props, state, map)\n  {\n    if(state.userMarker != null)\n    {\n      state.userMarker.setMap(null);\n    }\n\n    let user = new google.maps.Marker({\n      position: props.pos,\n      icon: './map/user_icon.svg',\n      title: \"Tu ubicaci√≥n\",\n      draggable:false,\n    })\n\n    user.setMap(map);\n    map.panTo(props.pos);\n\n    return user\n  }\n\n  static getStores(props, state, map)\n  {\n    let list = []\n    if(Array.isArray(props.stores) && props.stores.length)\n    {\n      stores = props.stores\n      for (let i = 0; i < stores.length; i++) {\n        store = this.storeMarker(stores[i], map)\n        list.push(store)\n      }\n        \n    }\n    else\n    {\n      for (let i = 0; i < state.stores.length; i++)\n      {\n        state.stores[i].setMap(null)\n      }\n    }\n\n    return list\n  }\n\n  static storeMarker(store, map)\n  {\n    if(store.id == null || store.lat == null || store.lng == null || store.name == null)\n    {\n      console.log(\"Skiped store #\"+i)\n    }\n    else\n    {\n\n      store.type = (store.type==null?\"store\":store.type.toLowerCase())\n      let icon_normal = './map/' + store.type + \"_icon.svg\";\n      let icon_hover = './map/' + store.type + \"_icon_hover.svg\";\n      \n      let marker = new google.maps.Marker({\n        position: {lat:store.lat, lng:store.lng},\n        icon: icon_normal,\n        title:store.name,\n        draggable:false,\n        id:store.id, //custom data\n      })\n\n      google.maps.event.addListener(marker, 'click', function() {\n        console.log(\"click \" +marker.id)       \n      })\n\n      google.maps.event.addListener(marker, 'mouseover', function() {\n        marker.setIcon(icon_hover);\n      })\n\n      google.maps.event.addListener(marker, 'mouseout', function() {\n        marker.setIcon(icon_normal);    \n      })\n\n      marker.setMap(map)\n    }\n    return marker\n  }\n\n  render () {\n    let customStyle = {\n      padding:\"0\",\n      margin:\"0\",\n      display: 'flex',\n      height: '97vh',\n\n      alignItems:'center', \n      justifyContent: 'center',\n      \n      background:'WhiteSmoke'\n    }\n\n    let imageStyle = {\n      width: \"50%\",\n      marginLeft:\"auto\",\n      marginRight: \"auto\"\n    }\n\n    const handleOpen = () => {\n      setOpen(true);\n    };\n  \n    const handleClose = () => {\n      setOpen(false);\n    };\n    \n    return (\n      <div>\n        <Head>\n          <script src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyBt0ZCE1kAklBJiBnCYGX6kl0tglLcKlLI\"></script>\n        </Head>\n        <div>\n          <div id=\"map\" style={customStyle}>\n            <img src=\"/loading.svg\" alt=\"Pajarito escuchando m√∫sica feliz\" style={imageStyle}></img>\n          </div>\n          {this.state.map\n            ?<AddressBar/>\n            :\"\"\n          }\n          {this.state.map && !this.state.stores.length\n            ?<NoStores/>\n            :\"\"\n          }\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Map\n"]},"metadata":{},"sourceType":"module"}