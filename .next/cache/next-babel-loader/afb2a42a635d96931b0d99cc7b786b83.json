{"ast":null,"code":"var _jsxFileName = \"/home/crmock/pideenlaequina/front/components/map.js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport Head from 'next/head';\nimport AddressBar from '../components/addressBar.js';\nimport NoStores from '../components/noStores.js';\n\nclass Map extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      map: null,\n      userMarker: null\n    };\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    let newMap = null;\n    let newUserMarker = null;\n    let newStores = [];\n\n    if (typeof google !== 'undefined' && props.pos != null && props.pos.lat != null && props.pos.lng != null) {\n      if (state.map == null) {\n        newMap = new google.maps.Map(document.getElementById('map'), {\n          center: props.pos,\n          zoom: 15,\n          mapTypeControl: false,\n          fullscreenControl: false,\n          clickableIcons: false\n        });\n      } else {\n        newMap = state.map;\n      }\n\n      if (state.userMarker != null) {\n        state.userMarker.setMap(null);\n      }\n\n      newUserMarker = new google.maps.Marker({\n        position: props.pos,\n        icon: './map/user_icon.svg',\n        title: \"Tu ubicación\",\n        draggable: false\n      });\n      newUserMarker.setMap(newMap);\n      newMap.panTo(props.pos);\n      let storeList = props.stores;\n      console.log(Array.isArray(storeList));\n      console.log(storeList.length);\n      console.log(storeList);\n\n      if (Array.isArray(storeList) && storeList.length > 0) {\n        for (let i = 0; i < storeList.length; i++) {\n          let store = storeList[i];\n\n          if (store._id == null || store.lat == null || store.lng == null || store.name == null) {\n            console.log(\"Skiped store #\" + i);\n            continue;\n          }\n\n          store.type = store.type == null ? \"store\" : store.type.toLowerCase();\n          let icon_normal = './map/' + store.type + \"_icon.svg\";\n          let icon_hover = './map/' + store.type + \"_icon_hover.svg\";\n          let marker = new google.maps.Marker({\n            position: {\n              lat: store.lat,\n              lng: store.lng\n            },\n            icon: icon_normal,\n            title: store.name,\n            draggable: false,\n            id: store.id //custom data\n\n          });\n          google.maps.event.addListener(marker, 'click', function () {\n            console.log(\"click \" + marker.id);\n          });\n          google.maps.event.addListener(marker, 'mouseover', function () {\n            marker.setIcon(icon_hover);\n          });\n          google.maps.event.addListener(marker, 'mouseout', function () {\n            marker.setIcon(icon_normal);\n          });\n          marker.setMap(newMap);\n        }\n      } else {\n        for (let i = 0; i < props.stores.length; i++) {\n          props.stores[i].setMap(null);\n        }\n      }\n    }\n\n    return {\n      map: newMap,\n      userMarker: newUserMarker,\n      stores: newStores\n    };\n  }\n\n  render() {\n    let customStyle = {\n      padding: \"0\",\n      margin: \"0\",\n      display: 'flex',\n      height: '97vh',\n      alignItems: 'center',\n      justifyContent: 'center',\n      background: 'WhiteSmoke'\n    };\n    let imageStyle = {\n      width: \"50%\",\n      marginLeft: \"auto\",\n      marginRight: \"auto\"\n    };\n\n    const handleOpen = () => {\n      setOpen(true);\n    };\n\n    const handleClose = () => {\n      setOpen(false);\n    };\n\n    return __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 7\n      }\n    }, __jsx(Head, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }\n    }, __jsx(\"script\", {\n      src: \"https://maps.googleapis.com/maps/api/js?key=AIzaSyBt0ZCE1kAklBJiBnCYGX6kl0tglLcKlLI\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 11\n      }\n    })), __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }\n    }, __jsx(\"div\", {\n      id: \"map\",\n      style: customStyle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 11\n      }\n    }, __jsx(\"img\", {\n      src: \"/loading.svg\",\n      alt: \"Pajarito escuchando m\\xFAsica feliz\",\n      style: imageStyle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 13\n      }\n    })), this.state.map ? __jsx(AddressBar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 14\n      }\n    }) : \"\", this.state.map && this.props.stores.length == 0 && this.props.isReady ? __jsx(NoStores, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 14\n      }\n    }) : \"\"));\n  }\n\n}\n\nexport default Map;","map":{"version":3,"sources":["/home/crmock/pideenlaequina/front/components/map.js"],"names":["React","ReactDOM","Head","AddressBar","NoStores","Map","Component","constructor","props","state","map","userMarker","getDerivedStateFromProps","newMap","newUserMarker","newStores","google","pos","lat","lng","maps","document","getElementById","center","zoom","mapTypeControl","fullscreenControl","clickableIcons","setMap","Marker","position","icon","title","draggable","panTo","storeList","stores","console","log","Array","isArray","length","i","store","_id","name","type","toLowerCase","icon_normal","icon_hover","marker","id","event","addListener","setIcon","render","customStyle","padding","margin","display","height","alignItems","justifyContent","background","imageStyle","width","marginLeft","marginRight","handleOpen","setOpen","handleClose","isReady"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAOC,IAAP,MAAiB,WAAjB;AACA,OAAOC,UAAP,MAAuB,6BAAvB;AACA,OAAOC,QAAP,MAAqB,2BAArB;;AAEA,MAAMC,GAAN,SAAkBL,KAAK,CAACM,SAAxB,CAAkC;AAEhCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACXC,MAAAA,GAAG,EAAE,IADM;AAEXC,MAAAA,UAAU,EAAE;AAFD,KAAb;AAID;;AAED,SAAOC,wBAAP,CAAgCJ,KAAhC,EAAuCC,KAAvC,EAA8C;AAC5C,QAAII,MAAM,GAAG,IAAb;AACA,QAAIC,aAAa,GAAG,IAApB;AACA,QAAIC,SAAS,GAAG,EAAhB;;AAEA,QAAG,OAAOC,MAAP,KAAkB,WAAlB,IAAiCR,KAAK,CAACS,GAAN,IAAa,IAA9C,IAAsDT,KAAK,CAACS,GAAN,CAAUC,GAAV,IAAiB,IAAvE,IAA+EV,KAAK,CAACS,GAAN,CAAUE,GAAV,IAAiB,IAAnG,EACA;AACE,UAAGV,KAAK,CAACC,GAAN,IAAa,IAAhB,EACA;AACEG,QAAAA,MAAM,GAAG,IAAIG,MAAM,CAACI,IAAP,CAAYf,GAAhB,CAAoBgB,QAAQ,CAACC,cAAT,CAAwB,KAAxB,CAApB,EAAoD;AAC3DC,UAAAA,MAAM,EAAEf,KAAK,CAACS,GAD6C;AAE3DO,UAAAA,IAAI,EAAE,EAFqD;AAG3DC,UAAAA,cAAc,EAAE,KAH2C;AAI3DC,UAAAA,iBAAiB,EAAE,KAJwC;AAK3DC,UAAAA,cAAc,EAAE;AAL2C,SAApD,CAAT;AAOD,OATD,MAWA;AACEd,QAAAA,MAAM,GAAGJ,KAAK,CAACC,GAAf;AACD;;AAED,UAAGD,KAAK,CAACE,UAAN,IAAoB,IAAvB,EACA;AACEF,QAAAA,KAAK,CAACE,UAAN,CAAiBiB,MAAjB,CAAwB,IAAxB;AACD;;AAEDd,MAAAA,aAAa,GAAG,IAAIE,MAAM,CAACI,IAAP,CAAYS,MAAhB,CAAuB;AACrCC,QAAAA,QAAQ,EAAEtB,KAAK,CAACS,GADqB;AAErCc,QAAAA,IAAI,EAAE,qBAF+B;AAGrCC,QAAAA,KAAK,EAAE,cAH8B;AAIrCC,QAAAA,SAAS,EAAC;AAJ2B,OAAvB,CAAhB;AAOAnB,MAAAA,aAAa,CAACc,MAAd,CAAqBf,MAArB;AACAA,MAAAA,MAAM,CAACqB,KAAP,CAAa1B,KAAK,CAACS,GAAnB;AAEA,UAAIkB,SAAS,GAAG3B,KAAK,CAAC4B,MAAtB;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYC,KAAK,CAACC,OAAN,CAAcL,SAAd,CAAZ;AACAE,MAAAA,OAAO,CAACC,GAAR,CAAYH,SAAS,CAACM,MAAtB;AACAJ,MAAAA,OAAO,CAACC,GAAR,CAAYH,SAAZ;;AACA,UAAGI,KAAK,CAACC,OAAN,CAAcL,SAAd,KAA4BA,SAAS,CAACM,MAAV,GAAiB,CAAhD,EACA;AAEE,aAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGP,SAAS,CAACM,MAA9B,EAAsCC,CAAC,EAAvC,EAA2C;AACzC,cAAIC,KAAK,GAAGR,SAAS,CAACO,CAAD,CAArB;;AAEA,cAAGC,KAAK,CAACC,GAAN,IAAa,IAAb,IAAqBD,KAAK,CAACzB,GAAN,IAAa,IAAlC,IAA0CyB,KAAK,CAACxB,GAAN,IAAa,IAAvD,IAA+DwB,KAAK,CAACE,IAAN,IAAc,IAAhF,EACA;AACER,YAAAA,OAAO,CAACC,GAAR,CAAY,mBAAiBI,CAA7B;AACA;AACD;;AAEDC,UAAAA,KAAK,CAACG,IAAN,GAAcH,KAAK,CAACG,IAAN,IAAY,IAAZ,GAAiB,OAAjB,GAAyBH,KAAK,CAACG,IAAN,CAAWC,WAAX,EAAvC;AACA,cAAIC,WAAW,GAAG,WAAWL,KAAK,CAACG,IAAjB,GAAwB,WAA1C;AACA,cAAIG,UAAU,GAAG,WAAWN,KAAK,CAACG,IAAjB,GAAwB,iBAAzC;AAEA,cAAII,MAAM,GAAG,IAAIlC,MAAM,CAACI,IAAP,CAAYS,MAAhB,CAAuB;AAClCC,YAAAA,QAAQ,EAAE;AAACZ,cAAAA,GAAG,EAACyB,KAAK,CAACzB,GAAX;AAAgBC,cAAAA,GAAG,EAACwB,KAAK,CAACxB;AAA1B,aADwB;AAElCY,YAAAA,IAAI,EAAEiB,WAF4B;AAGlChB,YAAAA,KAAK,EAACW,KAAK,CAACE,IAHsB;AAIlCZ,YAAAA,SAAS,EAAC,KAJwB;AAKlCkB,YAAAA,EAAE,EAACR,KAAK,CAACQ,EALyB,CAKrB;;AALqB,WAAvB,CAAb;AAQAnC,UAAAA,MAAM,CAACI,IAAP,CAAYgC,KAAZ,CAAkBC,WAAlB,CAA8BH,MAA9B,EAAsC,OAAtC,EAA+C,YAAW;AACxDb,YAAAA,OAAO,CAACC,GAAR,CAAY,WAAUY,MAAM,CAACC,EAA7B;AACD,WAFD;AAIAnC,UAAAA,MAAM,CAACI,IAAP,CAAYgC,KAAZ,CAAkBC,WAAlB,CAA8BH,MAA9B,EAAsC,WAAtC,EAAmD,YAAW;AAC5DA,YAAAA,MAAM,CAACI,OAAP,CAAeL,UAAf;AACD,WAFD;AAIAjC,UAAAA,MAAM,CAACI,IAAP,CAAYgC,KAAZ,CAAkBC,WAAlB,CAA8BH,MAA9B,EAAsC,UAAtC,EAAkD,YAAW;AAC3DA,YAAAA,MAAM,CAACI,OAAP,CAAeN,WAAf;AACD,WAFD;AAIAE,UAAAA,MAAM,CAACtB,MAAP,CAAcf,MAAd;AACD;AACF,OAtCD,MAwCA;AACE,aAAK,IAAI6B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGlC,KAAK,CAAC4B,MAAN,CAAaK,MAAjC,EAAyCC,CAAC,EAA1C,EACA;AACElC,UAAAA,KAAK,CAAC4B,MAAN,CAAaM,CAAb,EAAgBd,MAAhB,CAAuB,IAAvB;AACD;AACF;AACF;;AAED,WAAO;AACLlB,MAAAA,GAAG,EAAEG,MADA;AAELF,MAAAA,UAAU,EAAEG,aAFP;AAGLsB,MAAAA,MAAM,EAACrB;AAHF,KAAP;AAKD;;AAEDwC,EAAAA,MAAM,GAAI;AACR,QAAIC,WAAW,GAAG;AAChBC,MAAAA,OAAO,EAAC,GADQ;AAEhBC,MAAAA,MAAM,EAAC,GAFS;AAGhBC,MAAAA,OAAO,EAAE,MAHO;AAIhBC,MAAAA,MAAM,EAAE,MAJQ;AAMhBC,MAAAA,UAAU,EAAC,QANK;AAOhBC,MAAAA,cAAc,EAAE,QAPA;AAShBC,MAAAA,UAAU,EAAC;AATK,KAAlB;AAYA,QAAIC,UAAU,GAAG;AACfC,MAAAA,KAAK,EAAE,KADQ;AAEfC,MAAAA,UAAU,EAAC,MAFI;AAGfC,MAAAA,WAAW,EAAE;AAHE,KAAjB;;AAMA,UAAMC,UAAU,GAAG,MAAM;AACvBC,MAAAA,OAAO,CAAC,IAAD,CAAP;AACD,KAFD;;AAIA,UAAMC,WAAW,GAAG,MAAM;AACxBD,MAAAA,OAAO,CAAC,KAAD,CAAP;AACD,KAFD;;AAIA,WACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE,MAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAQ,MAAA,GAAG,EAAC,qFAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,EAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,EAAE,EAAC,KAAR;AAAc,MAAA,KAAK,EAAEb,WAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAK,MAAA,GAAG,EAAC,cAAT;AAAwB,MAAA,GAAG,EAAC,qCAA5B;AAA+D,MAAA,KAAK,EAAEQ,UAAtE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,EAIG,KAAKvD,KAAL,CAAWC,GAAX,GACE,MAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,GAEE,EANL,EAQG,KAAKD,KAAL,CAAWC,GAAX,IAAkB,KAAKF,KAAL,CAAW4B,MAAX,CAAkBK,MAAlB,IAA0B,CAA5C,IAAiD,KAAKjC,KAAL,CAAW+D,OAA5D,GACE,MAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,GAEE,EAVL,CAJF,CADF;AAoBD;;AAzJ+B;;AA4JlC,eAAelE,GAAf","sourcesContent":["import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Head from 'next/head'\nimport AddressBar from '../components/addressBar.js'\nimport NoStores from '../components/noStores.js'\n\nclass Map extends React.Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      map: null,\n      userMarker: null\n    }\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    let newMap = null\n    let newUserMarker = null\n    let newStores = []\n\n    if(typeof google !== 'undefined' && props.pos != null && props.pos.lat != null && props.pos.lng != null) \n    {\n      if(state.map == null)\n      {\n        newMap = new google.maps.Map(document.getElementById('map'), {\n          center: props.pos,\n          zoom: 15,\n          mapTypeControl: false,\n          fullscreenControl: false,\n          clickableIcons: false\n        })\n      }\n      else\n      {\n        newMap = state.map\n      }\n\n      if(state.userMarker != null)\n      {\n        state.userMarker.setMap(null);\n      }\n\n      newUserMarker = new google.maps.Marker({\n        position: props.pos,\n        icon: './map/user_icon.svg',\n        title: \"Tu ubicación\",\n        draggable:false,\n      })\n\n      newUserMarker.setMap(newMap);\n      newMap.panTo(props.pos);\n\n      let storeList = props.stores\n      console.log(Array.isArray(storeList))\n      console.log(storeList.length)\n      console.log(storeList)\n      if(Array.isArray(storeList) && storeList.length>0)\n      {\n        \n        for (let i = 0; i < storeList.length; i++) {\n          let store = storeList[i]\n          \n          if(store._id == null || store.lat == null || store.lng == null || store.name == null)\n          {\n            console.log(\"Skiped store #\"+i)\n            continue\n          }\n    \n          store.type = (store.type==null?\"store\":store.type.toLowerCase())\n          let icon_normal = './map/' + store.type + \"_icon.svg\";\n          let icon_hover = './map/' + store.type + \"_icon_hover.svg\";\n          \n          let marker = new google.maps.Marker({\n            position: {lat:store.lat, lng:store.lng},\n            icon: icon_normal,\n            title:store.name,\n            draggable:false,\n            id:store.id, //custom data\n          })\n    \n          google.maps.event.addListener(marker, 'click', function() {\n            console.log(\"click \" +marker.id)       \n          })\n    \n          google.maps.event.addListener(marker, 'mouseover', function() {\n            marker.setIcon(icon_hover);\n          })\n      \n          google.maps.event.addListener(marker, 'mouseout', function() {\n            marker.setIcon(icon_normal);    \n          })\n\n          marker.setMap(newMap)\n        }\n      }\n      else\n      {\n        for (let i = 0; i < props.stores.length; i++)\n        {\n          props.stores[i].setMap(null)\n        }\n      }\n    }\n\n    return {\n      map: newMap,\n      userMarker: newUserMarker,\n      stores:newStores\n    }\n  }\n\n  render () {\n    let customStyle = {\n      padding:\"0\",\n      margin:\"0\",\n      display: 'flex',\n      height: '97vh',\n\n      alignItems:'center', \n      justifyContent: 'center',\n      \n      background:'WhiteSmoke'\n    }\n\n    let imageStyle = {\n      width: \"50%\",\n      marginLeft:\"auto\",\n      marginRight: \"auto\"\n    }\n\n    const handleOpen = () => {\n      setOpen(true);\n    };\n  \n    const handleClose = () => {\n      setOpen(false);\n    };\n    \n    return (\n      <div>\n        <Head>\n          <script src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyBt0ZCE1kAklBJiBnCYGX6kl0tglLcKlLI\"></script>\n        </Head>\n        <div>\n          <div id=\"map\" style={customStyle}>\n            <img src=\"/loading.svg\" alt=\"Pajarito escuchando música feliz\" style={imageStyle}></img>\n          </div>\n          {this.state.map\n            ?<AddressBar/>\n            :\"\"\n          }\n          {this.state.map && this.props.stores.length==0 && this.props.isReady\n            ?<NoStores/>\n            :\"\"\n          }\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Map\n"]},"metadata":{},"sourceType":"module"}