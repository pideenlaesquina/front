{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/crmock/pideenlaequina/front/components/map.js\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport Head from 'next/head';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Input from '@material-ui/core/Input';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport FormControl from '@material-ui/core/FormControl';\nimport TextField from '@material-ui/core/TextField';\nimport PersonPinCircleIcon from '@material-ui/icons/PersonPinCircle';\nimport IconButton from '@material-ui/core/IconButton';\nimport SearchIcon from '@material-ui/icons/Search';\nimport AddLocationIcon from '@material-ui/icons/AddLocation';\nimport PanToUser from '../components/panToUser.js';\nimport NoStores from '../components/noStores.js';\nvar initialZoom = 15;\n\nvar Map = /*#__PURE__*/function (_React$Component) {\n  _inherits(Map, _React$Component);\n\n  var _super = _createSuper(Map);\n\n  function Map(props) {\n    var _this;\n\n    _classCallCheck(this, Map);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      map: null,\n      userMarker: null,\n      storeMarkers: []\n    };\n    return _this;\n  }\n\n  _createClass(Map, [{\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate() {\n      if (this.props.pos == null) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (this.props.pos != null && this.props.stores != null) {\n        if (this.state.map == null) {\n          var map = this.getMap(this.props.pos);\n          var userMarker = this.placeUserMarker(map, this.props.pos);\n          var storeMarkers = this.placeAllStoreMarkers(map, this.props.stores);\n          this.setState({\n            userMarker: userMarker,\n            map: map,\n            storeMarkers: storeMarkers\n          });\n        } else if (prevProps.pos != this.props.pos) {\n          var _userMarker = this.placeUserMarker(this.state.map, this.props.pos);\n\n          this.removeAllStoreMarkers();\n\n          var _storeMarkers = this.placeAllStoreMarkers(this.state.map, this.props.stores);\n\n          this.setState({\n            userMarker: _userMarker,\n            storeMarkers: _storeMarkers\n          });\n        }\n      }\n    }\n  }, {\n    key: \"getMap\",\n    value: function getMap(pos) {\n      var map = null;\n\n      if (this.state.map == null) {\n        map = new google.maps.Map(document.getElementById('map'), {\n          center: pos,\n          zoom: initialZoom,\n          zoomControl: false,\n          mapTypeControl: false,\n          fullscreenControl: false,\n          clickableIcons: false,\n          streetViewControl: false\n        });\n      } else {\n        map = this.state.map;\n      }\n\n      return map;\n    }\n  }, {\n    key: \"placeUserMarker\",\n    value: function placeUserMarker(map, pos) {\n      if (this.state.userMarker != null) {\n        this.state.userMarker.setMap(null);\n      }\n\n      var marker = new google.maps.Marker({\n        position: pos,\n        icon: './map/user_icon.svg',\n        title: \"Tu ubicaci√≥n\",\n        draggable: false\n      });\n      marker.setMap(map);\n      this.panToPos(map, pos);\n      return marker;\n    }\n  }, {\n    key: \"panToPos\",\n    value: function panToPos(map, pos) {\n      map.setZoom(initialZoom);\n      map.panTo(pos);\n    }\n  }, {\n    key: \"placeAllStoreMarkers\",\n    value: function placeAllStoreMarkers(map, stores) {\n      var list = [];\n\n      for (var i = 0; i < stores.length; i++) {\n        var store = stores[i];\n\n        if (store._id == null || store.lat == null || store.lng == null || store.name == null) {\n          console.log(\"Skiped store: \" + store.name);\n          continue;\n        }\n\n        var marker = this.placeAStoreMarker(map, store);\n        list.push(marker);\n      }\n\n      return list;\n    }\n  }, {\n    key: \"removeAllStoreMarkers\",\n    value: function removeAllStoreMarkers() {\n      for (var i = 0; i < this.state.storeMarkers.length; i++) {\n        this.state.storeMarkers[i].setMap(null);\n      }\n    }\n  }, {\n    key: \"placeAStoreMarker\",\n    value: function placeAStoreMarker(map, store) {\n      store.type = store.type == null ? \"store\" : store.type.toLowerCase();\n      var icon_normal = './map/' + store.type + \"_icon.svg\";\n      var icon_hover = './map/' + store.type + \"_icon_hover.svg\";\n      var marker = new google.maps.Marker({\n        position: {\n          lat: store.lat,\n          lng: store.lng\n        },\n        icon: icon_normal,\n        title: store.name,\n        draggable: false,\n        id: store._id //custom data\n\n      });\n      google.maps.event.addListener(marker, 'click', function () {\n        console.log(\"click \" + marker.id);\n      });\n      google.maps.event.addListener(marker, 'mouseover', function () {\n        marker.setIcon(icon_hover);\n      });\n      google.maps.event.addListener(marker, 'mouseout', function () {\n        marker.setIcon(icon_normal);\n      });\n      marker.setMap(map);\n      return marker;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var customStyle = {\n        padding: \"0\",\n        margin: \"0\",\n        display: 'flex',\n        height: '97vh',\n        flexDirection: \"column-reverse\"\n      };\n      var google_url = process.env.GOOGLE_MAPS_API_URL + \"/js?key=\" + process.env.GOOGLE_MAPS_API_KEY;\n      return __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 7\n        }\n      }, __jsx(Head, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 9\n        }\n      }, __jsx(\"script\", {\n        src: google_url,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 11\n        }\n      })), __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 9\n        }\n      }, __jsx(\"div\", {\n        style: customStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 11\n        }\n      }, __jsx(\"div\", {\n        id: \"actions\",\n        style: {\n          background: 'gold',\n          height: \"250px\",\n          width: \"100%\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 13\n        }\n      }, __jsx(Grid, {\n        container: true,\n        spacing: 3,\n        style: {\n          width: \"80%\",\n          marginTop: \"3%\",\n          marginLeft: \"auto\",\n          marginRight: \"auto\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 15\n        }\n      }, __jsx(Grid, {\n        item: true,\n        xs: 12,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 17\n        }\n      }, __jsx(Paper, {\n        elevation: 3,\n        style: {\n          borderRadius: \"25px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 19\n        }\n      }, __jsx(FormControl, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 21\n        }\n      }, __jsx(InputLabel, {\n        htmlFor: \"input-address\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 23\n        }\n      }, \"Ubicaci\\xF3n\"), __jsx(Input, {\n        id: \"input-addres\",\n        startAdornment: __jsx(InputAdornment, {\n          position: \"start\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 27\n          }\n        }, __jsx(PersonPinCircleIcon, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 29\n          }\n        })),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 23\n        }\n      })))), __jsx(Grid, {\n        item: true,\n        xs: 4,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 17\n        }\n      }, __jsx(Paper, {\n        elevation: 3,\n        style: {\n          borderRadius: \"20px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 19\n        }\n      }, __jsx(IconButton, {\n        \"aria-label\": \"delete\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215,\n          columnNumber: 21\n        }\n      }, __jsx(SearchIcon, {\n        fontSize: \"large\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 23\n        }\n      })))), __jsx(Grid, {\n        item: true,\n        xs: 4,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 17\n        }\n      }, __jsx(Paper, {\n        elevation: 3,\n        style: {\n          borderRadius: \"20px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 19\n        }\n      }, __jsx(IconButton, {\n        \"aria-label\": \"delete\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 21\n        }\n      }, __jsx(AddLocationIcon, {\n        fontSize: \"large\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 23\n        }\n      })))), __jsx(Grid, {\n        item: true,\n        xs: 4,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 17\n        }\n      }, __jsx(Paper, {\n        elevation: 3,\n        style: {\n          borderRadius: \"20px\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 19\n        }\n      }, __jsx(IconButton, {\n        \"aria-label\": \"delete\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 21\n        }\n      }, __jsx(AddLocationIcon, {\n        fontSize: \"large\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 23\n        }\n      })))))), __jsx(\"div\", {\n        id: \"map\",\n        style: {\n          background: \"grey\",\n          height: \"100%\",\n          width: \"100%\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 13\n        }\n      }, this.state.map ? __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 16\n        }\n      }, __jsx(PanToUser, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 21\n        }\n      })) : \"\")), this.state.map && this.props.stores.length == 0 ? __jsx(NoStores, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 14\n        }\n      }) : \"\"));\n    }\n  }]);\n\n  return Map;\n}(React.Component);\n\nexport default Map;","map":{"version":3,"sources":["/home/crmock/pideenlaequina/front/components/map.js"],"names":["React","ReactDOM","Head","Grid","Paper","Input","InputLabel","InputAdornment","FormControl","TextField","PersonPinCircleIcon","IconButton","SearchIcon","AddLocationIcon","PanToUser","NoStores","initialZoom","Map","props","state","map","userMarker","storeMarkers","pos","prevProps","prevState","stores","getMap","placeUserMarker","placeAllStoreMarkers","setState","removeAllStoreMarkers","google","maps","document","getElementById","center","zoom","zoomControl","mapTypeControl","fullscreenControl","clickableIcons","streetViewControl","setMap","marker","Marker","position","icon","title","draggable","panToPos","setZoom","panTo","list","i","length","store","_id","lat","lng","name","console","log","placeAStoreMarker","push","type","toLowerCase","icon_normal","icon_hover","id","event","addListener","setIcon","customStyle","padding","margin","display","height","flexDirection","google_url","process","env","GOOGLE_MAPS_API_URL","GOOGLE_MAPS_API_KEY","background","width","marginTop","marginLeft","marginRight","borderRadius","Component"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAOC,IAAP,MAAiB,WAAjB;AAEA,OAAOC,IAAP,MAAiB,wBAAjB;AACA,OAAOC,KAAP,MAAkB,yBAAlB;AACA,OAAOC,KAAP,MAAkB,yBAAlB;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AACA,OAAOC,cAAP,MAA2B,kCAA3B;AACA,OAAOC,WAAP,MAAwB,+BAAxB;AACA,OAAOC,SAAP,MAAsB,6BAAtB;AACA,OAAOC,mBAAP,MAAgC,oCAAhC;AAEA,OAAOC,UAAP,MAAuB,8BAAvB;AACA,OAAOC,UAAP,MAAuB,2BAAvB;AACA,OAAOC,eAAP,MAA4B,gCAA5B;AAEA,OAAOC,SAAP,MAAsB,4BAAtB;AACA,OAAOC,QAAP,MAAqB,2BAArB;AAEA,IAAMC,WAAW,GAAG,EAApB;;IAEMC,G;;;;;AAEJ,eAAYC,KAAZ,EACA;AAAA;;AAAA;;AACE,8BAAMA,KAAN;AACA,UAAKC,KAAL,GAAa;AACXC,MAAAA,GAAG,EAAE,IADM;AAEXC,MAAAA,UAAU,EAAC,IAFA;AAGXC,MAAAA,YAAY,EAAC;AAHF,KAAb;AAFF;AAOC;;;;4CAEuB;AACtB,UAAG,KAAKJ,KAAL,CAAWK,GAAX,IAAkB,IAArB,EACA;AACE,eAAO,KAAP;AACD;;AACD,aAAO,IAAP;AACD;;;uCAEkBC,S,EAAWC,S,EAC9B;AACE,UAAG,KAAKP,KAAL,CAAWK,GAAX,IAAkB,IAAlB,IAA0B,KAAKL,KAAL,CAAWQ,MAAX,IAAqB,IAAlD,EACA;AACE,YAAG,KAAKP,KAAL,CAAWC,GAAX,IAAkB,IAArB,EACA;AACE,cAAIA,GAAG,GAAC,KAAKO,MAAL,CAAY,KAAKT,KAAL,CAAWK,GAAvB,CAAR;AACA,cAAIF,UAAU,GAAC,KAAKO,eAAL,CAAqBR,GAArB,EAA0B,KAAKF,KAAL,CAAWK,GAArC,CAAf;AACA,cAAID,YAAY,GAAG,KAAKO,oBAAL,CAA0BT,GAA1B,EAA+B,KAAKF,KAAL,CAAWQ,MAA1C,CAAnB;AAEA,eAAKI,QAAL,CAAe;AACbT,YAAAA,UAAU,EAACA,UADE;AAEbD,YAAAA,GAAG,EAAEA,GAFQ;AAGbE,YAAAA,YAAY,EAAEA;AAHD,WAAf;AAKD,SAXD,MAYK,IAAGE,SAAS,CAACD,GAAV,IAAiB,KAAKL,KAAL,CAAWK,GAA/B,EACL;AACE,cAAIF,WAAU,GAAC,KAAKO,eAAL,CAAqB,KAAKT,KAAL,CAAWC,GAAhC,EAAqC,KAAKF,KAAL,CAAWK,GAAhD,CAAf;;AACA,eAAKQ,qBAAL;;AACA,cAAIT,aAAY,GAAG,KAAKO,oBAAL,CAA0B,KAAKV,KAAL,CAAWC,GAArC,EAA0C,KAAKF,KAAL,CAAWQ,MAArD,CAAnB;;AAEA,eAAKI,QAAL,CAAe;AACbT,YAAAA,UAAU,EAACA,WADE;AAEbC,YAAAA,YAAY,EAAEA;AAFD,WAAf;AAID;AACF;AACF;;;2BAEMC,G,EACP;AACE,UAAIH,GAAG,GAAG,IAAV;;AACA,UAAG,KAAKD,KAAL,CAAWC,GAAX,IAAkB,IAArB,EACA;AACEA,QAAAA,GAAG,GAAG,IAAIY,MAAM,CAACC,IAAP,CAAYhB,GAAhB,CAAoBiB,QAAQ,CAACC,cAAT,CAAwB,KAAxB,CAApB,EAAoD;AACxDC,UAAAA,MAAM,EAAEb,GADgD;AAExDc,UAAAA,IAAI,EAAErB,WAFkD;AAGxDsB,UAAAA,WAAW,EAAC,KAH4C;AAIxDC,UAAAA,cAAc,EAAE,KAJwC;AAKxDC,UAAAA,iBAAiB,EAAE,KALqC;AAMxDC,UAAAA,cAAc,EAAE,KANwC;AAOxDC,UAAAA,iBAAiB,EAAE;AAPqC,SAApD,CAAN;AASD,OAXD,MAaA;AACEtB,QAAAA,GAAG,GAAG,KAAKD,KAAL,CAAWC,GAAjB;AACD;;AACD,aAAOA,GAAP;AACD;;;oCAEeA,G,EAAKG,G,EACrB;AACE,UAAG,KAAKJ,KAAL,CAAWE,UAAX,IAAyB,IAA5B,EACA;AACE,aAAKF,KAAL,CAAWE,UAAX,CAAsBsB,MAAtB,CAA6B,IAA7B;AACD;;AAED,UAAIC,MAAM,GAAG,IAAIZ,MAAM,CAACC,IAAP,CAAYY,MAAhB,CAAuB;AAClCC,QAAAA,QAAQ,EAAEvB,GADwB;AAElCwB,QAAAA,IAAI,EAAE,qBAF4B;AAGlCC,QAAAA,KAAK,EAAE,cAH2B;AAIlCC,QAAAA,SAAS,EAAC;AAJwB,OAAvB,CAAb;AAOAL,MAAAA,MAAM,CAACD,MAAP,CAAcvB,GAAd;AACA,WAAK8B,QAAL,CAAc9B,GAAd,EAAmBG,GAAnB;AAEA,aAAOqB,MAAP;AACD;;;6BAEQxB,G,EAAKG,G,EACd;AACEH,MAAAA,GAAG,CAAC+B,OAAJ,CAAYnC,WAAZ;AACAI,MAAAA,GAAG,CAACgC,KAAJ,CAAU7B,GAAV;AACD;;;yCAEoBH,G,EAAKM,M,EAC1B;AACE,UAAI2B,IAAI,GAAG,EAAX;;AAEA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG5B,MAAM,CAAC6B,MAA3B,EAAmCD,CAAC,EAApC,EAAwC;AACtC,YAAIE,KAAK,GAAG9B,MAAM,CAAC4B,CAAD,CAAlB;;AACA,YAAGE,KAAK,CAACC,GAAN,IAAa,IAAb,IAAqBD,KAAK,CAACE,GAAN,IAAa,IAAlC,IAA0CF,KAAK,CAACG,GAAN,IAAa,IAAvD,IAA+DH,KAAK,CAACI,IAAN,IAAc,IAAhF,EACA;AACEC,UAAAA,OAAO,CAACC,GAAR,CAAY,mBAAiBN,KAAK,CAACI,IAAnC;AACA;AACD;;AAED,YAAIhB,MAAM,GAAG,KAAKmB,iBAAL,CAAuB3C,GAAvB,EAA4BoC,KAA5B,CAAb;AACAH,QAAAA,IAAI,CAACW,IAAL,CAAUpB,MAAV;AACD;;AAED,aAAOS,IAAP;AACD;;;4CAGD;AACE,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKnC,KAAL,CAAWG,YAAX,CAAwBiC,MAA5C,EAAoDD,CAAC,EAArD,EACA;AACE,aAAKnC,KAAL,CAAWG,YAAX,CAAwBgC,CAAxB,EAA2BX,MAA3B,CAAkC,IAAlC;AACD;AACF;;;sCAEiBvB,G,EAAKoC,K,EACvB;AACEA,MAAAA,KAAK,CAACS,IAAN,GAAcT,KAAK,CAACS,IAAN,IAAY,IAAZ,GAAiB,OAAjB,GAAyBT,KAAK,CAACS,IAAN,CAAWC,WAAX,EAAvC;AACA,UAAIC,WAAW,GAAG,WAAWX,KAAK,CAACS,IAAjB,GAAwB,WAA1C;AACA,UAAIG,UAAU,GAAG,WAAWZ,KAAK,CAACS,IAAjB,GAAwB,iBAAzC;AAEA,UAAIrB,MAAM,GAAG,IAAIZ,MAAM,CAACC,IAAP,CAAYY,MAAhB,CAAuB;AAClCC,QAAAA,QAAQ,EAAE;AAACY,UAAAA,GAAG,EAACF,KAAK,CAACE,GAAX;AAAgBC,UAAAA,GAAG,EAACH,KAAK,CAACG;AAA1B,SADwB;AAElCZ,QAAAA,IAAI,EAAEoB,WAF4B;AAGlCnB,QAAAA,KAAK,EAACQ,KAAK,CAACI,IAHsB;AAIlCX,QAAAA,SAAS,EAAC,KAJwB;AAKlCoB,QAAAA,EAAE,EAACb,KAAK,CAACC,GALyB,CAKpB;;AALoB,OAAvB,CAAb;AAQAzB,MAAAA,MAAM,CAACC,IAAP,CAAYqC,KAAZ,CAAkBC,WAAlB,CAA8B3B,MAA9B,EAAsC,OAAtC,EAA+C,YAAW;AACxDiB,QAAAA,OAAO,CAACC,GAAR,CAAY,WAAUlB,MAAM,CAACyB,EAA7B;AACD,OAFD;AAIArC,MAAAA,MAAM,CAACC,IAAP,CAAYqC,KAAZ,CAAkBC,WAAlB,CAA8B3B,MAA9B,EAAsC,WAAtC,EAAmD,YAAW;AAC5DA,QAAAA,MAAM,CAAC4B,OAAP,CAAeJ,UAAf;AACD,OAFD;AAIApC,MAAAA,MAAM,CAACC,IAAP,CAAYqC,KAAZ,CAAkBC,WAAlB,CAA8B3B,MAA9B,EAAsC,UAAtC,EAAkD,YAAW;AAC3DA,QAAAA,MAAM,CAAC4B,OAAP,CAAeL,WAAf;AACD,OAFD;AAIAvB,MAAAA,MAAM,CAACD,MAAP,CAAcvB,GAAd;AACA,aAAOwB,MAAP;AACD;;;6BAES;AACR,UAAI6B,WAAW,GAAG;AAChBC,QAAAA,OAAO,EAAC,GADQ;AAEhBC,QAAAA,MAAM,EAAC,GAFS;AAGhBC,QAAAA,OAAO,EAAE,MAHO;AAIhBC,QAAAA,MAAM,EAAE,MAJQ;AAKhBC,QAAAA,aAAa,EAAE;AALC,OAAlB;AAQA,UAAIC,UAAU,GAAGC,OAAO,CAACC,GAAR,CAAYC,mBAAZ,GAAkC,UAAlC,GAA6CF,OAAO,CAACC,GAAR,CAAYE,mBAA1E;AAEA,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAQ,QAAA,GAAG,EAAGJ,UAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CADF,EAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,KAAK,EAAEN,WAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,EAAE,EAAC,SAAR;AAAkB,QAAA,KAAK,EAAE;AAACW,UAAAA,UAAU,EAAC,MAAZ;AAAoBP,UAAAA,MAAM,EAAC,OAA3B;AAAoCQ,UAAAA,KAAK,EAAC;AAA1C,SAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,IAAD;AAAM,QAAA,SAAS,MAAf;AAAgB,QAAA,OAAO,EAAE,CAAzB;AAA4B,QAAA,KAAK,EAAE;AAACA,UAAAA,KAAK,EAAC,KAAP;AAAcC,UAAAA,SAAS,EAAC,IAAxB;AAA8BC,UAAAA,UAAU,EAAC,MAAzC;AAAiDC,UAAAA,WAAW,EAAC;AAA7D,SAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,IAAD;AAAM,QAAA,IAAI,MAAV;AAAW,QAAA,EAAE,EAAE,EAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,KAAD;AAAO,QAAA,SAAS,EAAE,CAAlB;AAAqB,QAAA,KAAK,EAAE;AAACC,UAAAA,YAAY,EAAC;AAAd,SAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,UAAD;AAAY,QAAA,OAAO,EAAC,eAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,EAEE,MAAC,KAAD;AACE,QAAA,EAAE,EAAC,cADL;AAEE,QAAA,cAAc,EACZ,MAAC,cAAD;AAAgB,UAAA,QAAQ,EAAC,OAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE,MAAC,mBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF,CAHJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFF,CADF,CADF,CADF,EAgBE,MAAC,IAAD;AAAM,QAAA,IAAI,MAAV;AAAW,QAAA,EAAE,EAAE,CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,KAAD;AAAO,QAAA,SAAS,EAAE,CAAlB;AAAqB,QAAA,KAAK,EAAE;AAACA,UAAAA,YAAY,EAAC;AAAd,SAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,UAAD;AAAY,sBAAW,QAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,UAAD;AAAY,QAAA,QAAQ,EAAC,OAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CADF,CADF,CAhBF,EAuBE,MAAC,IAAD;AAAM,QAAA,IAAI,MAAV;AAAW,QAAA,EAAE,EAAE,CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,KAAD;AAAO,QAAA,SAAS,EAAE,CAAlB;AAAqB,QAAA,KAAK,EAAE;AAACA,UAAAA,YAAY,EAAC;AAAd,SAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,UAAD;AAAY,sBAAW,QAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,eAAD;AAAiB,QAAA,QAAQ,EAAC,OAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CADF,CADF,CAvBF,EA8BE,MAAC,IAAD;AAAM,QAAA,IAAI,MAAV;AAAW,QAAA,EAAE,EAAE,CAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,KAAD;AAAO,QAAA,SAAS,EAAE,CAAlB;AAAqB,QAAA,KAAK,EAAE;AAACA,UAAAA,YAAY,EAAC;AAAd,SAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,UAAD;AAAY,sBAAW,QAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,MAAC,eAAD;AAAiB,QAAA,QAAQ,EAAC,OAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CADF,CADF,CA9BF,CADF,CADF,EA2CE;AAAK,QAAA,EAAE,EAAC,KAAR;AAAc,QAAA,KAAK,EAAE;AAACL,UAAAA,UAAU,EAAC,MAAZ;AAAmBP,UAAAA,MAAM,EAAC,MAA1B;AAAkCQ,UAAAA,KAAK,EAAC;AAAxC,SAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAKlE,KAAL,CAAWC,GAAX,GACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAK,MAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAL,CADA,GAEA,EAHH,CA3CF,CADF,EAoDG,KAAKD,KAAL,CAAWC,GAAX,IAAkB,KAAKF,KAAL,CAAWQ,MAAX,CAAkB6B,MAAlB,IAA0B,CAA5C,GACE,MAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,GAEE,EAtDL,CAJF,CADF;AAgED;;;;EAtOevD,KAAK,CAAC0F,S;;AAyOxB,eAAezE,GAAf","sourcesContent":["import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Head from 'next/head'\n\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Input from '@material-ui/core/Input';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport InputAdornment from '@material-ui/core/InputAdornment';\nimport FormControl from '@material-ui/core/FormControl';\nimport TextField from '@material-ui/core/TextField';\nimport PersonPinCircleIcon from '@material-ui/icons/PersonPinCircle';\n\nimport IconButton from '@material-ui/core/IconButton'\nimport SearchIcon from '@material-ui/icons/Search'\nimport AddLocationIcon from '@material-ui/icons/AddLocation'\n\nimport PanToUser from '../components/panToUser.js'\nimport NoStores from '../components/noStores.js'\n\nconst initialZoom = 15\n\nclass Map extends React.Component {\n\n  constructor(props)\n  {\n    super(props)\n    this.state = {\n      map: null,\n      userMarker:null,\n      storeMarkers:[]\n    }\n  }\n\n  shouldComponentUpdate() {\n    if(this.props.pos == null)\n    {\n      return false\n    }\n    return true\n  }\n\n  componentDidUpdate(prevProps, prevState) \n  {\n    if(this.props.pos != null && this.props.stores != null)\n    {\n      if(this.state.map == null)\n      {\n        let map=this.getMap(this.props.pos)\n        let userMarker=this.placeUserMarker(map, this.props.pos)\n        let storeMarkers = this.placeAllStoreMarkers(map, this.props.stores)\n\n        this.setState ({\n          userMarker:userMarker,\n          map: map,\n          storeMarkers: storeMarkers\n        })\n      }\n      else if(prevProps.pos != this.props.pos)\n      {\n        let userMarker=this.placeUserMarker(this.state.map, this.props.pos)\n        this.removeAllStoreMarkers()\n        let storeMarkers = this.placeAllStoreMarkers(this.state.map, this.props.stores)\n\n        this.setState ({\n          userMarker:userMarker,\n          storeMarkers: storeMarkers\n        })\n      }\n    }\n  }\n\n  getMap(pos)\n  {\n    let map = null\n    if(this.state.map == null)\n    {\n      map = new google.maps.Map(document.getElementById('map'), {\n        center: pos,\n        zoom: initialZoom,\n        zoomControl:false,\n        mapTypeControl: false,\n        fullscreenControl: false,\n        clickableIcons: false,\n        streetViewControl: false\n      })\n    }\n    else\n    {\n      map = this.state.map\n    }\n    return map\n  }\n\n  placeUserMarker(map, pos)\n  {\n    if(this.state.userMarker != null)\n    {\n      this.state.userMarker.setMap(null);\n    }\n\n    let marker = new google.maps.Marker({\n      position: pos,\n      icon: './map/user_icon.svg',\n      title: \"Tu ubicaci√≥n\",\n      draggable:false,\n    })\n\n    marker.setMap(map);\n    this.panToPos(map, pos)\n\n    return marker\n  }\n\n  panToPos(map, pos)\n  {\n    map.setZoom(initialZoom);\n    map.panTo(pos);\n  }\n\n  placeAllStoreMarkers(map, stores)\n  {\n    let list = []\n    \n    for (let i = 0; i < stores.length; i++) {\n      let store = stores[i]\n      if(store._id == null || store.lat == null || store.lng == null || store.name == null)\n      {\n        console.log(\"Skiped store: \"+store.name)\n        continue\n      }\n\n      let marker = this.placeAStoreMarker(map, store)\n      list.push(marker)\n    }\n\n    return list\n  }\n\n  removeAllStoreMarkers()\n  {\n    for (let i = 0; i < this.state.storeMarkers.length; i++)\n    {\n      this.state.storeMarkers[i].setMap(null)\n    }\n  }\n\n  placeAStoreMarker(map, store)\n  {\n    store.type = (store.type==null?\"store\":store.type.toLowerCase())\n    let icon_normal = './map/' + store.type + \"_icon.svg\";\n    let icon_hover = './map/' + store.type + \"_icon_hover.svg\";\n    \n    let marker = new google.maps.Marker({\n      position: {lat:store.lat, lng:store.lng},\n      icon: icon_normal,\n      title:store.name,\n      draggable:false,\n      id:store._id, //custom data\n    })\n\n    google.maps.event.addListener(marker, 'click', function() {\n      console.log(\"click \" +marker.id)       \n    })\n\n    google.maps.event.addListener(marker, 'mouseover', function() {\n      marker.setIcon(icon_hover);\n    })\n\n    google.maps.event.addListener(marker, 'mouseout', function() {\n      marker.setIcon(icon_normal);    \n    })\n\n    marker.setMap(map)\n    return marker\n  }\n\n  render () {\n    let customStyle = {\n      padding:\"0\",\n      margin:\"0\",\n      display: 'flex',\n      height: '97vh',\n      flexDirection: \"column-reverse\"\n    }\n\n    let google_url = process.env.GOOGLE_MAPS_API_URL + \"/js?key=\"+process.env.GOOGLE_MAPS_API_KEY\n\n    return (\n      <div>\n        <Head>\n          <script src= {google_url}></script>\n        </Head>\n        <div>\n          <div style={customStyle}>\n            <div id=\"actions\" style={{background:'gold', height:\"250px\", width:\"100%\"}}>\n              <Grid container spacing={3} style={{width:\"80%\", marginTop:\"3%\", marginLeft:\"auto\", marginRight:\"auto\"}}>\n                <Grid item xs={12}>\n                  <Paper elevation={3} style={{borderRadius:\"25px\"}}>\n                    <FormControl>\n                      <InputLabel htmlFor=\"input-address\">Ubicaci√≥n</InputLabel>\n                      <Input\n                        id=\"input-addres\"\n                        startAdornment={\n                          <InputAdornment position=\"start\">\n                            <PersonPinCircleIcon />\n                          </InputAdornment>\n                        }\n                      />\n                    </FormControl>\n                  </Paper>\n                </Grid>\n                <Grid item xs={4}>\n                  <Paper elevation={3} style={{borderRadius:\"20px\"}}>\n                    <IconButton aria-label=\"delete\">\n                      <SearchIcon fontSize=\"large\" />\n                    </IconButton>\n                  </Paper>\n                </Grid>\n                <Grid item xs={4}>\n                  <Paper elevation={3} style={{borderRadius:\"20px\"}}>\n                    <IconButton aria-label=\"delete\">\n                      <AddLocationIcon fontSize=\"large\" />\n                    </IconButton>\n                  </Paper>\n                </Grid>\n                <Grid item xs={4}>\n                  <Paper elevation={3} style={{borderRadius:\"20px\"}}>\n                    <IconButton aria-label=\"delete\">\n                      <AddLocationIcon fontSize=\"large\" />\n                    </IconButton>\n                  </Paper>\n                </Grid>\n              </Grid>\n              \n              \n            </div>\n            <div id=\"map\" style={{background:\"grey\",height:\"100%\", width:\"100%\"}}>\n              {this.state.map\n              ?<div><PanToUser/></div>\n              :\"\"\n              }\n            </div>\n          </div>\n          \n          {this.state.map && this.props.stores.length==0\n            ?<NoStores/>\n            :\"\"\n          }\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Map\n"]},"metadata":{},"sourceType":"module"}