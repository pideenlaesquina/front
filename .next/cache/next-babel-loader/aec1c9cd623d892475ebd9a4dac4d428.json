{"ast":null,"code":"// Import Dependenciesmn   cv\nimport url from 'url';\nimport MongoClient from 'mongodb'; // Create cached connection variable\n\nlet cachedDb = null;\nlet uri = process.env.MONGODB_URI; // A function for connecting to MongoDB,\n// taking a single parameter of the connection string\n\nasync function connectToDatabase() {\n  // If the database connection is cached,\n  // use it instead of creating a new connection\n  if (cachedDb) {\n    return cachedDb;\n  } // If no connection is cached, create a new one\n\n\n  const client = await MongoClient.connect(uri, {\n    useNewUrlParser: true,\n    useUnifiedTopology: true\n  }); // Select the database through the connection,\n  // using the database path of the connection string\n\n  const db = await client.db(url.parse(uri).pathname.substr(1)); // Cache the database connection and return the connection\n\n  cachedDb = db;\n  return db;\n}\n\nexport default connectToDatabase;","map":{"version":3,"sources":["/home/crmock/pideenlaequina/front/middleware/mongodb.js"],"names":["url","MongoClient","cachedDb","uri","process","env","MONGODB_URI","connectToDatabase","client","connect","useNewUrlParser","useUnifiedTopology","db","parse","pathname","substr"],"mappings":"AAAA;AACA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,WAAP,MAAwB,SAAxB,C,CAEA;;AACA,IAAIC,QAAQ,GAAG,IAAf;AACA,IAAIC,GAAG,GAAGC,OAAO,CAACC,GAAR,CAAYC,WAAtB,C,CAEA;AACA;;AACA,eAAeC,iBAAf,GAAmC;AACjC;AACA;AACA,MAAIL,QAAJ,EAAc;AACZ,WAAOA,QAAP;AACD,GALgC,CAOjC;;;AACA,QAAMM,MAAM,GAAG,MAAMP,WAAW,CAACQ,OAAZ,CAAoBN,GAApB,EAAyB;AAAEO,IAAAA,eAAe,EAAE,IAAnB;AAAyBC,IAAAA,kBAAkB,EAAE;AAA7C,GAAzB,CAArB,CARiC,CAUjC;AACA;;AACA,QAAMC,EAAE,GAAG,MAAMJ,MAAM,CAACI,EAAP,CAAUZ,GAAG,CAACa,KAAJ,CAAUV,GAAV,EAAeW,QAAf,CAAwBC,MAAxB,CAA+B,CAA/B,CAAV,CAAjB,CAZiC,CAcjC;;AACAb,EAAAA,QAAQ,GAAGU,EAAX;AACA,SAAOA,EAAP;AACD;;AAED,eAAeL,iBAAf","sourcesContent":["// Import Dependenciesmn   cv\nimport url from 'url';\nimport MongoClient from 'mongodb';\n\n// Create cached connection variable\nlet cachedDb = null\nlet uri = process.env.MONGODB_URI\n\n// A function for connecting to MongoDB,\n// taking a single parameter of the connection string\nasync function connectToDatabase() {\n  // If the database connection is cached,\n  // use it instead of creating a new connection\n  if (cachedDb) {\n    return cachedDb\n  }\n\n  // If no connection is cached, create a new one\n  const client = await MongoClient.connect(uri, { useNewUrlParser: true, useUnifiedTopology: true  })\n\n  // Select the database through the connection,\n  // using the database path of the connection string\n  const db = await client.db(url.parse(uri).pathname.substr(1))\n\n  // Cache the database connection and return the connection\n  cachedDb = db\n  return db\n}\n\nexport default connectToDatabase;"]},"metadata":{},"sourceType":"module"}