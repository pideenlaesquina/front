{"ast":null,"code":"var _jsxFileName = \"/home/crmock/pideenlaequina/front/components/map.js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport Head from 'next/head';\n\nclass Map extends React.Component {\n  componentDidMount() {\n    this.initMap();\n  }\n\n  initMap() {\n    this.map = new google.maps.Map(document.getElementById('map'), {\n      center: {\n        lat: this.props.lat,\n        lng: this.props.lng\n      },\n      zoom: 15,\n      mapTypeControl: false,\n      fullscreenControl: false\n    });\n  }\n\n  async loadMapData(pos, initial = true) {\n    if (initial) {\n      addMarker(\"user\", pos.lat, pos.lng, \"user\", \"Tu ubicación\", null, null, null, null, true);\n    }\n\n    map.panTo(pos);\n    var stores = await getStores(pos); //TODO: issue#7 Agregar control que muestra mensaje \"lo sentimos no hay tiendas cerca de tí, agrega la primera\"\n\n    for (var i = 0; i < stores.length; i++) {\n      addMarker(stores[i].id, stores[i].lat, stores[i].lng, stores[i].type, stores[i].name, stores[i].address, stores[i].cellphone, stores[i].phone, stores[i].aceptsCreditCard);\n    }\n\n    ;\n  }\n\n  addMarker(id, lat, lng, markerType, name, address, cellphone, phone, aceptsCreditCard, draggable = false) {\n    var icon_normal = './images/store_icon.svg';\n    var icon_hover = './images/store_icon_hover.svg';\n\n    if (markerType != null) {\n      icon_normal = './images/' + markerType.toLowerCase() + \"_icon.svg\";\n      icon_hover = './images/' + markerType.toLowerCase() + \"_icon_hover.svg\";\n    }\n\n    var marker = new google.maps.Marker({\n      position: {\n        lat: lat,\n        lng: lng\n      },\n      icon: icon_normal,\n      title: name,\n      draggable: draggable,\n      //custom data\n      id: id,\n      name: name,\n      address: address,\n      type: markerType ? markerType.toLowerCase() : null,\n      cellphone: cellphone,\n      phone: phone,\n      aceptsCreditCard: aceptsCreditCard\n    });\n\n    if (marker.id == \"user\") {\n      infoWindow.setContent('<div id=\"content\">' + '<p>Arrastra este cursor para cargar las tiendas cercanas</p>' + '</div>');\n      infoWindow.open(map, marker);\n    }\n\n    google.maps.event.addListener(marker, 'click', function () {\n      if (marker.id != \"user\") {\n        infoWindow.setContent('<div id=\"content\">' + '<h4 id=\"firstHeading\" class=\"firstHeading\">' + marker.name + '</h4>' + '<p>' + marker.address + '</p>' + (marker.aceptsCreditCard ? '<p><i class=\"fa fa-credit-card\"></i> Acepta tarjetas</p>' : \"\") + '<div class=\"map-button-block\">' + '<button class=\"map-button phone\" type=\"submit\" value=\"Call\" onclick=\"callAction(' + marker.phone + ')\"><i class=\"fa fa-phone\"></i> Llamar</button>' + '<button class=\"map-button whatsapp\" type=\"submit\" value=\"Write\" onclick=\"writeAction(' + marker.cellphone + ')\"><i class=\"fa fa-whatsapp\"></i> Escribir</button>' + '</div>' + '</div>');\n        infoWindow.open(map, marker);\n      }\n    });\n    google.maps.event.addListener(marker, 'mouseover', function () {\n      marker.setIcon(icon_hover);\n    });\n    google.maps.event.addListener(marker, 'mouseout', function () {\n      marker.setIcon(icon_normal);\n    });\n    google.maps.event.addListener(marker, 'dragend', function (event) {\n      loadMapData({\n        lat: Number(event.latLng.lat().toFixed(6)),\n        lng: Number(event.latLng.lng().toFixed(6))\n      }, false);\n    });\n    marker.setMap(map);\n  }\n\n  render() {\n    var customStyle = {\n      padding: \"0\",\n      margin: \"0\",\n      display: 'block',\n      height: '97vh',\n      background: 'WhiteSmoke'\n    };\n    return __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 7\n      }\n    }, __jsx(Head, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }\n    }, __jsx(\"script\", {\n      src: \"https://maps.googleapis.com/maps/api/js?key=AIzaSyBt0ZCE1kAklBJiBnCYGX6kl0tglLcKlLI\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }\n    })), __jsx(\"div\", {\n      id: \"map\",\n      style: customStyle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }\n    }, \"Cargando...\"));\n  }\n\n}\n\nexport default Map;","map":{"version":3,"sources":["/home/crmock/pideenlaequina/front/components/map.js"],"names":["React","ReactDOM","Head","Map","Component","componentDidMount","initMap","map","google","maps","document","getElementById","center","lat","props","lng","zoom","mapTypeControl","fullscreenControl","loadMapData","pos","initial","addMarker","panTo","stores","getStores","i","length","id","type","name","address","cellphone","phone","aceptsCreditCard","markerType","draggable","icon_normal","icon_hover","toLowerCase","marker","Marker","position","icon","title","infoWindow","setContent","open","event","addListener","setIcon","Number","latLng","toFixed","setMap","render","customStyle","padding","margin","display","height","background"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Head from 'next/head'\n\nclass Map extends React.Component {\n\n  componentDidMount() \n  {\n    this.initMap();\n  }\n\n  initMap()\n  {\n    this.map = new google.maps.Map(document.getElementById('map'), {\n      center: {lat:this.props.lat, lng: this.props.lng},\n      zoom: 15,\n      mapTypeControl: false,\n      fullscreenControl: false,\n    });\n  }\n\n  async loadMapData(pos, initial=true)\n  {\n    if(initial)\n    {\n      addMarker(\"user\", pos.lat, pos.lng, \"user\", \"Tu ubicación\", null, null, null, null, true);\n    }\n\n    map.panTo(pos);\n    var stores = await getStores(pos);\n\n    //TODO: issue#7 Agregar control que muestra mensaje \"lo sentimos no hay tiendas cerca de tí, agrega la primera\"\n    for (var i = 0; i < stores.length; i++) {\n      addMarker(stores[i].id, stores[i].lat, stores[i].lng, stores[i].type, stores[i].name, stores[i].address, stores[i].cellphone, stores[i].phone, stores[i].aceptsCreditCard);\n    };\n  }\n\n  addMarker(id,lat, lng, markerType, name, address, cellphone, phone, aceptsCreditCard, draggable=false)\n  {\n    var icon_normal = './images/store_icon.svg';\n    var icon_hover = './images/store_icon_hover.svg';\n\n    if (markerType != null)\n    {\n      icon_normal = './images/' + markerType.toLowerCase() + \"_icon.svg\";\n      icon_hover = './images/' + markerType.toLowerCase() + \"_icon_hover.svg\";\n    }\n\n    var marker = new google.maps.Marker({\n        position: {lat:lat, lng:lng},\n        icon: icon_normal,\n        title:name,\n        draggable:draggable,\n\n        //custom data\n        id:id,\n        name:name,\n        address:address,\n        type:(markerType?markerType.toLowerCase():null),\n        cellphone:cellphone,\n        phone:phone,\n        aceptsCreditCard: aceptsCreditCard\n    });\n\n    if(marker.id==\"user\")\n    {\n      infoWindow.setContent(\n        '<div id=\"content\">'+\n          '<p>Arrastra este cursor para cargar las tiendas cercanas</p>'+\n        '</div>'\n      );\n      infoWindow.open(map, marker); \n    }\n\n    google.maps.event.addListener(marker, 'click', function() {\n      if(marker.id != \"user\")\n      {\n        infoWindow.setContent(\n          '<div id=\"content\">'+\n            '<h4 id=\"firstHeading\" class=\"firstHeading\">'+ marker.name +'</h4>'+\n            '<p>'+ marker.address +'</p>'+\n            (marker.aceptsCreditCard?'<p><i class=\"fa fa-credit-card\"></i> Acepta tarjetas</p>':\"\")+\n            '<div class=\"map-button-block\">'+\n              '<button class=\"map-button phone\" type=\"submit\" value=\"Call\" onclick=\"callAction('+marker.phone+')\"><i class=\"fa fa-phone\"></i> Llamar</button>'+\n              '<button class=\"map-button whatsapp\" type=\"submit\" value=\"Write\" onclick=\"writeAction('+marker.cellphone+')\"><i class=\"fa fa-whatsapp\"></i> Escribir</button>'+\n            '</div>'+\n          '</div>'\n        );\n        infoWindow.open(map, marker); \n      }                     \n    });\n\n    google.maps.event.addListener(marker, 'mouseover', function() {\n      marker.setIcon(icon_hover);\n    });\n\n    google.maps.event.addListener(marker, 'mouseout', function() {\n      marker.setIcon(icon_normal);    \n    });\n\n    google.maps.event.addListener(marker, 'dragend', function(event) {\n      loadMapData({ lat: Number(event.latLng.lat().toFixed(6)) , lng: Number(event.latLng.lng().toFixed(6)) }, false);\n    });\n\n    marker.setMap(map);\n  }\n\n  render () {\n    var customStyle = {\n      padding:\"0\",\n      margin:\"0\",\n      display: 'block',\n      height: '97vh',\n      \n      background:'WhiteSmoke'\n    }\n    \n    return (\n      <div>\n        <Head>\n          <script src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyBt0ZCE1kAklBJiBnCYGX6kl0tglLcKlLI\"></script>\n        </Head>\n        <div id=\"map\" style={customStyle}>Cargando...</div>\n      </div>\n    )\n  }\n}\n\nexport default Map\n"]},"metadata":{},"sourceType":"module"}