{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/crmock/pideenlaequina/front/components/map.js\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport Head from 'next/head';\nimport AddressBar from '../components/addressBar.js';\nimport NoStores from '../components/noStores.js';\n\nvar Map = /*#__PURE__*/function (_React$Component) {\n  _inherits(Map, _React$Component);\n\n  var _super = _createSuper(Map);\n\n  function Map(props) {\n    _classCallCheck(this, Map);\n\n    return _super.call(this, props);\n  }\n\n  _createClass(Map, [{\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate() {\n      if (this.props.pos === null) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.map = this.getMap();\n      this.userMarker = this.placeUserMarker(map, this.props.pos);\n      this.removeAllStoreMarkers();\n      this.storeMarkers = this.placeAllStoreMarkers(map, this.props.stores);\n    }\n  }, {\n    key: \"getMap\",\n    value: function getMap() {\n      var map = null;\n\n      if (this.map == null) {\n        map = new google.maps.Map(document.getElementById('map'), {\n          center: this.props.pos,\n          zoom: 15,\n          mapTypeControl: false,\n          fullscreenControl: false,\n          clickableIcons: false,\n          streetViewControl: false\n        });\n      } else {\n        map = this.map;\n      }\n\n      return map;\n    }\n  }, {\n    key: \"placeUserMarker\",\n    value: function placeUserMarker(map, pos) {\n      if (this.userMarker != null) {\n        this.state.userMarker.setMap(null);\n      }\n\n      var marker = new google.maps.Marker({\n        position: pos,\n        icon: './map/user_icon.svg',\n        title: \"Tu ubicación\",\n        draggable: false\n      });\n      marker.setMap(map);\n      this.panToPos(map, pos);\n      return marker;\n    }\n  }, {\n    key: \"panToPos\",\n    value: function panToPos(map, pos) {\n      map.panTo(this.props);\n    }\n  }, {\n    key: \"placeAllStoreMarkers\",\n    value: function placeAllStoreMarkers(map, stores) {\n      var storeMarkers = [];\n\n      for (var i = 0; i < stores.length; i++) {\n        var store = storeList[i];\n\n        if (store._id == null || store.lat == null || store.lng == null || store.name == null) {\n          console.log(\"Skiped store: \" + store.name);\n          continue;\n        }\n\n        var marker = placeAStoreMarker(map, store);\n        storeMarkers.push(marker);\n      }\n\n      return storeMarkers;\n    }\n  }, {\n    key: \"removeAllStoreMarkers\",\n    value: function removeAllStoreMarkers() {\n      for (var i = 0; i < this.state.storeMarkers.length; i++) {\n        props.stores[i].setMap(null);\n      }\n    }\n  }, {\n    key: \"placeAStoreMarker\",\n    value: function placeAStoreMarker(map, store) {\n      store.type = store.type == null ? \"store\" : store.type.toLowerCase();\n      var icon_normal = './map/' + store.type + \"_icon.svg\";\n      var icon_hover = './map/' + store.type + \"_icon_hover.svg\";\n      var marker = new google.maps.Marker({\n        position: {\n          lat: store.lat,\n          lng: store.lng\n        },\n        icon: icon_normal,\n        title: store.name,\n        draggable: false,\n        id: store.id //custom data\n\n      });\n      google.maps.event.addListener(marker, 'click', function () {\n        console.log(\"click \" + marker.id);\n      });\n      google.maps.event.addListener(marker, 'mouseover', function () {\n        marker.setIcon(icon_hover);\n      });\n      google.maps.event.addListener(marker, 'mouseout', function () {\n        marker.setIcon(icon_normal);\n      });\n      marker.setMap(map);\n      return marker;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var customStyle = {\n        padding: \"0\",\n        margin: \"0\",\n        display: 'flex',\n        height: '97vh',\n        alignItems: 'center',\n        justifyContent: 'center',\n        background: 'WhiteSmoke'\n      };\n      var imageStyle = {\n        width: \"50%\",\n        marginLeft: \"auto\",\n        marginRight: \"auto\"\n      };\n      return __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 7\n        }\n      }, __jsx(Head, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 9\n        }\n      }, __jsx(\"script\", {\n        src: \"https://maps.googleapis.com/maps/api/js?key=AIzaSyBt0ZCE1kAklBJiBnCYGX6kl0tglLcKlLI\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 11\n        }\n      })), __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 9\n        }\n      }, __jsx(\"div\", {\n        id: \"map\",\n        style: customStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }\n      }, __jsx(\"img\", {\n        src: \"/loading.svg\",\n        alt: \"Pajarito escuchando m\\xFAsica feliz\",\n        style: imageStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 13\n        }\n      })), this.state.map ? __jsx(AddressBar, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 14\n        }\n      }) : \"\", this.state.map && this.props.stores.length == 0 ? __jsx(NoStores, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 14\n        }\n      }) : \"\"));\n    }\n  }]);\n\n  return Map;\n}(React.Component);\n\nexport default Map;","map":{"version":3,"sources":["/home/crmock/pideenlaequina/front/components/map.js"],"names":["React","ReactDOM","Head","AddressBar","NoStores","Map","props","pos","map","getMap","userMarker","placeUserMarker","removeAllStoreMarkers","storeMarkers","placeAllStoreMarkers","stores","google","maps","document","getElementById","center","zoom","mapTypeControl","fullscreenControl","clickableIcons","streetViewControl","state","setMap","marker","Marker","position","icon","title","draggable","panToPos","panTo","i","length","store","storeList","_id","lat","lng","name","console","log","placeAStoreMarker","push","type","toLowerCase","icon_normal","icon_hover","id","event","addListener","setIcon","customStyle","padding","margin","display","height","alignItems","justifyContent","background","imageStyle","width","marginLeft","marginRight","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Head from 'next/head'\nimport AddressBar from '../components/addressBar.js'\nimport NoStores from '../components/noStores.js'\n\nclass Map extends React.Component {\n\n  constructor(props) {\n    super(props)\n  }\n\n  shouldComponentUpdate() {\n    if(this.props.pos === null)\n    {\n      return false\n    }\n    return true\n  }\n\n  componentDidUpdate()\n  {\n    this.map=this.getMap()\n    this.userMarker=this.placeUserMarker(map, this.props.pos)\n    this.removeAllStoreMarkers()\n    this.storeMarkers = this.placeAllStoreMarkers(map, this.props.stores)\n  }\n\n  getMap()\n  {\n    let map = null\n    if(this.map == null)\n    {\n      map = new google.maps.Map(document.getElementById('map'), {\n        center: this.props.pos,\n        zoom: 15,\n        mapTypeControl: false,\n        fullscreenControl: false,\n        clickableIcons: false,\n        streetViewControl: false,\n      })\n    }\n    else\n    {\n      map = this.map\n    }\n\n    return map\n  }\n\n  placeUserMarker(map, pos)\n  {\n    if(this.userMarker != null)\n    {\n      this.state.userMarker.setMap(null);\n    }\n\n    let marker = new google.maps.Marker({\n      position: pos,\n      icon: './map/user_icon.svg',\n      title: \"Tu ubicación\",\n      draggable:false,\n    })\n\n    marker.setMap(map);\n    this.panToPos(map, pos)\n    return marker\n  }\n\n  panToPos(map, pos)\n  {\n    map.panTo(this.props);\n  }\n\n  placeAllStoreMarkers(map, stores)\n  {\n    let storeMarkers = []\n    \n    for (let i = 0; i < stores.length; i++) {\n      let store = storeList[i]\n      if(store._id == null || store.lat == null || store.lng == null || store.name == null)\n      {\n        console.log(\"Skiped store: \"+store.name)\n        continue\n      }\n\n      let marker = placeAStoreMarker(map, store)\n      storeMarkers.push(marker)\n    }\n\n    return storeMarkers\n  }\n\n  removeAllStoreMarkers()\n  {\n    for (let i = 0; i < this.state.storeMarkers.length; i++)\n    {\n      props.stores[i].setMap(null)\n    }\n  }\n\n  placeAStoreMarker(map, store)\n  {\n    store.type = (store.type==null?\"store\":store.type.toLowerCase())\n    let icon_normal = './map/' + store.type + \"_icon.svg\";\n    let icon_hover = './map/' + store.type + \"_icon_hover.svg\";\n    \n    let marker = new google.maps.Marker({\n      position: {lat:store.lat, lng:store.lng},\n      icon: icon_normal,\n      title:store.name,\n      draggable:false,\n      id:store.id, //custom data\n    })\n\n    google.maps.event.addListener(marker, 'click', function() {\n      console.log(\"click \" +marker.id)       \n    })\n\n    google.maps.event.addListener(marker, 'mouseover', function() {\n      marker.setIcon(icon_hover);\n    })\n\n    google.maps.event.addListener(marker, 'mouseout', function() {\n      marker.setIcon(icon_normal);    \n    })\n\n    marker.setMap(map)\n    return marker\n  }\n\n  render () {\n    let customStyle = {\n      padding:\"0\",\n      margin:\"0\",\n      display: 'flex',\n      height: '97vh',\n\n      alignItems:'center', \n      justifyContent: 'center',\n      \n      background:'WhiteSmoke'\n    }\n\n    let imageStyle = {\n      width: \"50%\",\n      marginLeft:\"auto\",\n      marginRight: \"auto\"\n    }\n    \n    return (\n      <div>\n        <Head>\n          <script src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyBt0ZCE1kAklBJiBnCYGX6kl0tglLcKlLI\"></script>\n        </Head>\n        <div>\n          <div id=\"map\" style={customStyle}>\n            <img src=\"/loading.svg\" alt=\"Pajarito escuchando música feliz\" style={imageStyle}></img>\n          </div>\n          {this.state.map\n            ?<AddressBar/>\n            :\"\"\n          }\n          {this.state.map && this.props.stores.length==0\n            ?<NoStores/>\n            :\"\"\n          }\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Map\n"]},"metadata":{},"sourceType":"module"}