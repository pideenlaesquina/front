{"ast":null,"code":"var _jsxFileName = \"/home/crmock/pideenlaequina/front/components/map.js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport Head from 'next/head';\nimport AddressBar from '../components/addressBar.js';\nimport NoStores from '../components/noStores.js';\n\nfunction getUser(props, state, map) {\n  if (state.userMarker != null) {\n    state.userMarker.setMap(null);\n  }\n\n  let user = new google.maps.Marker({\n    position: props.pos,\n    icon: './map/user_icon.svg',\n    title: \"Tu ubicación\",\n    draggable: false\n  });\n  user.setMap(map);\n  map.panTo(props.pos);\n  return user;\n}\n\nfunction getStores(props, state, map) {\n  let list = [];\n\n  if (Array.isArray(props.stores) && props.stores.length) {\n    stores = props.stores;\n\n    for (let i = 0; i < stores.length; i++) {\n      store = this.storeMarker(stores[i], map);\n      list.push(store);\n    }\n  } else {\n    for (let i = 0; i < state.stores.length; i++) {\n      state.stores[i].setMap(null);\n    }\n  }\n\n  return list;\n}\n\nfunction storeMarker(store, map) {\n  let marker = null;\n\n  if (store.id == null || store.lat == null || store.lng == null || store.name == null) {\n    console.log(\"Skiped store #\" + i);\n  } else {\n    store.type = store.type == null ? \"store\" : store.type.toLowerCase();\n    let icon_normal = './map/' + store.type + \"_icon.svg\";\n    let icon_hover = './map/' + store.type + \"_icon_hover.svg\";\n    marker = new google.maps.Marker({\n      position: {\n        lat: store.lat,\n        lng: store.lng\n      },\n      icon: icon_normal,\n      title: store.name,\n      draggable: false,\n      id: store.id //custom data\n\n    });\n    google.maps.event.addListener(marker, 'click', function () {\n      console.log(\"click \" + marker.id);\n    });\n    google.maps.event.addListener(marker, 'mouseover', function () {\n      marker.setIcon(icon_hover);\n    });\n    google.maps.event.addListener(marker, 'mouseout', function () {\n      marker.setIcon(icon_normal);\n    });\n    marker.setMap(map);\n  }\n\n  return marker;\n}\n\nclass Map extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      map: null,\n      userMarker: null,\n      stores: []\n    };\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    let newMap = null;\n    let newUserMarker = null;\n    let newStores = [];\n\n    if (typeof google !== 'undefined' && props.pos != null && props.pos.lat != null && props.pos.lng != null) {\n      newMap = this.getMap(props, state);\n      newUserMarker = this.getUser(props, state, newMap);\n      newStores = this.getSores(props, state, newMap);\n    }\n\n    return {\n      map: newMap,\n      userMarker: newUserMarker,\n      stores: newStores\n    };\n  }\n\n  static getMap(props, state) {\n    let map = null;\n\n    if (state.map == null) {\n      map = new google.maps.Map(document.getElementById('map'), {\n        center: props.pos,\n        zoom: 15,\n        mapTypeControl: false,\n        fullscreenControl: false\n      });\n    } else {\n      map = state.map;\n    }\n\n    return map;\n  }\n\n  render() {\n    let customStyle = {\n      padding: \"0\",\n      margin: \"0\",\n      display: 'flex',\n      height: '97vh',\n      alignItems: 'center',\n      justifyContent: 'center',\n      background: 'WhiteSmoke'\n    };\n    let imageStyle = {\n      width: \"50%\",\n      marginLeft: \"auto\",\n      marginRight: \"auto\"\n    };\n\n    const handleOpen = () => {\n      setOpen(true);\n    };\n\n    const handleClose = () => {\n      setOpen(false);\n    };\n\n    return __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 7\n      }\n    }, __jsx(Head, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 9\n      }\n    }, __jsx(\"script\", {\n      src: \"https://maps.googleapis.com/maps/api/js?key=AIzaSyBt0ZCE1kAklBJiBnCYGX6kl0tglLcKlLI\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 11\n      }\n    })), __jsx(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 9\n      }\n    }, __jsx(\"div\", {\n      id: \"map\",\n      style: customStyle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 11\n      }\n    }, __jsx(\"img\", {\n      src: \"/loading.svg\",\n      alt: \"Pajarito escuchando m\\xFAsica feliz\",\n      style: imageStyle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 13\n      }\n    })), this.state.map ? __jsx(AddressBar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 14\n      }\n    }) : \"\", this.state.map && !this.state.stores.length ? __jsx(NoStores, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 14\n      }\n    }) : \"\"));\n  }\n\n}\n\nexport default Map;","map":{"version":3,"sources":["/home/crmock/pideenlaequina/front/components/map.js"],"names":["React","ReactDOM","Head","AddressBar","NoStores","getUser","props","state","map","userMarker","setMap","user","google","maps","Marker","position","pos","icon","title","draggable","panTo","getStores","list","Array","isArray","stores","length","i","store","storeMarker","push","marker","id","lat","lng","name","console","log","type","toLowerCase","icon_normal","icon_hover","event","addListener","setIcon","Map","Component","constructor","getDerivedStateFromProps","newMap","newUserMarker","newStores","getMap","getSores","document","getElementById","center","zoom","mapTypeControl","fullscreenControl","render","customStyle","padding","margin","display","height","alignItems","justifyContent","background","imageStyle","width","marginLeft","marginRight","handleOpen","setOpen","handleClose"],"mappings":"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","sourcesContent":["import React from 'react'\nimport ReactDOM from 'react-dom'\nimport Head from 'next/head'\nimport AddressBar from '../components/addressBar.js'\nimport NoStores from '../components/noStores.js'\n\nfunction getUser(props, state, map)\n{\n  if(state.userMarker != null)\n  {\n    state.userMarker.setMap(null);\n  }\n\n  let user = new google.maps.Marker({\n    position: props.pos,\n    icon: './map/user_icon.svg',\n    title: \"Tu ubicación\",\n    draggable:false,\n  })\n\n  user.setMap(map);\n  map.panTo(props.pos);\n\n  return user\n}\n\nfunction getStores(props, state, map)\n{\n  let list = []\n  if(Array.isArray(props.stores) && props.stores.length)\n  {\n    stores = props.stores\n    for (let i = 0; i < stores.length; i++) {\n      store = this.storeMarker(stores[i], map)\n      list.push(store)\n    }\n      \n  }\n  else\n  {\n    for (let i = 0; i < state.stores.length; i++)\n    {\n      state.stores[i].setMap(null)\n    }\n  }\n\n  return list\n}\n\nfunction storeMarker(store, map)\n{\n  let marker = null\n  if(store.id == null || store.lat == null || store.lng == null || store.name == null)\n  {\n    console.log(\"Skiped store #\"+i)\n  }\n  else\n  {\n\n    store.type = (store.type==null?\"store\":store.type.toLowerCase())\n    let icon_normal = './map/' + store.type + \"_icon.svg\";\n    let icon_hover = './map/' + store.type + \"_icon_hover.svg\";\n    \n    marker = new google.maps.Marker({\n      position: {lat:store.lat, lng:store.lng},\n      icon: icon_normal,\n      title:store.name,\n      draggable:false,\n      id:store.id, //custom data\n    })\n\n    google.maps.event.addListener(marker, 'click', function() {\n      console.log(\"click \" +marker.id)       \n    })\n\n    google.maps.event.addListener(marker, 'mouseover', function() {\n      marker.setIcon(icon_hover);\n    })\n\n    google.maps.event.addListener(marker, 'mouseout', function() {\n      marker.setIcon(icon_normal);    \n    })\n\n    marker.setMap(map)\n  }\n  return marker\n}\n\nclass Map extends React.Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      map: null,\n      userMarker: null,\n      stores: []\n    }\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    let newMap = null\n    let newUserMarker = null\n    let newStores = []\n\n    if(typeof google !== 'undefined' && props.pos != null && props.pos.lat != null && props.pos.lng != null) \n    {\n      newMap = this.getMap(props, state)\n      newUserMarker = this.getUser(props, state, newMap)\n      newStores = this.getSores(props, state, newMap)\n    }\n\n    return {\n      map: newMap,\n      userMarker: newUserMarker,\n      stores:newStores\n    }\n  }\n\n  static getMap(props, state)\n  {\n    let map = null\n    if(state.map == null)\n    {\n      map = new google.maps.Map(document.getElementById('map'), {\n        center: props.pos,\n        zoom: 15,\n        mapTypeControl: false,\n        fullscreenControl: false,\n      })\n    }\n    else\n    {\n      map = state.map\n    }\n\n    return map\n  }\n\n  render () {\n    let customStyle = {\n      padding:\"0\",\n      margin:\"0\",\n      display: 'flex',\n      height: '97vh',\n\n      alignItems:'center', \n      justifyContent: 'center',\n      \n      background:'WhiteSmoke'\n    }\n\n    let imageStyle = {\n      width: \"50%\",\n      marginLeft:\"auto\",\n      marginRight: \"auto\"\n    }\n\n    const handleOpen = () => {\n      setOpen(true);\n    };\n  \n    const handleClose = () => {\n      setOpen(false);\n    };\n    \n    return (\n      <div>\n        <Head>\n          <script src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyBt0ZCE1kAklBJiBnCYGX6kl0tglLcKlLI\"></script>\n        </Head>\n        <div>\n          <div id=\"map\" style={customStyle}>\n            <img src=\"/loading.svg\" alt=\"Pajarito escuchando música feliz\" style={imageStyle}></img>\n          </div>\n          {this.state.map\n            ?<AddressBar/>\n            :\"\"\n          }\n          {this.state.map && !this.state.stores.length\n            ?<NoStores/>\n            :\"\"\n          }\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Map\n"]},"metadata":{},"sourceType":"module"}