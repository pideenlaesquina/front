{"version":3,"file":"static/webpack/static/development/pages/index.js.7004965946a94999d4b7.hot-update.js","sources":["webpack:///./pages/index.js"],"sourcesContent":["import React, { Component, Fragment} from 'react'\nimport Map from '../components/map.js'\n\nclass App extends Component {\n  constructor(props) {\n    super(props)\n    this.state = { \n      pos:null,\n      stores:null\n    }\n  }\n\n  componentDidMount() {\n    this.position()\n  }\n\n  componentDidUpdate(prevProps, prevState)\n  {\n    if (this.state.pos != null && (prevState.pos != this.state.pos))\n    {\n      this.getStores(this.state.pos)\n    }\n  }\n\n  position = async () => {\n    await navigator.geolocation.getCurrentPosition(\n      position => this.setState({ pos:{\n        lat: position.coords.latitude, \n        lng: position.coords.longitude\n      }}), \n      err => async function()\n      {\n        let ip = await fetch(process.env.IPIFY_URL).then(response=>response.text())\n        let pos = await fetch(process.env.IPGEOLOCATION_API_URL +'/ipgeo?apiKey='+process.env.IPGEOLOCATION_API_KEY+'&ip='+ip).then(response=>response.json())\n    \n        this.setState({ pos:{lat:parseFloat(pos.latitude), lng:parseFloat(pos.longitude)}, stores:null})\n      }\n    )\n  }\n\n  async getStores(pos)\n  {\n    let url = '/api/stores?lat='+ pos.lat +'&lng='+pos.lng\n    let res = await fetch(url).then(response=>response.json())\n    \n    this.setState({ stores:res.stores })\n  }\n  \n  render() {\n    return (\n      <div>\n        <Map pos={this.state.pos} stores={this.state.stores} googleMapsJsUrl={process.env.GOOGLE_MAPS_API_URL + \"/js?key=\"+process.env.GOOGLE_MAPS_API_KEY}/>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AAoBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAHA;AAEA;AAFA;AAAA;AAGA;AAAA;AACA;AAJA;AAGA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAnBA;AACA;AACA;AAFA;AAFA;AAMA;AACA;;;AACA;AACA;AACA;;;AAEA;AAEA;AAEA;AACA;AACA;;;AAkBA;;;;;;AAEA;;AACA;AAAA;AAAA;AACA;;AADA;AAEA;AAAA;AAAA;AACA;;;;;;;;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;;;;AAnDA;AACA;AAqDA;;;;;A","sourceRoot":""}